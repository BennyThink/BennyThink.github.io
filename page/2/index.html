<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>土豆不好吃</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="土豆不好吃">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="土豆不好吃">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Benny小土豆">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="土豆不好吃" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">土豆不好吃</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-immersion/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/03/immersion/index/" class="article-date">
  <time class="dt-published" datetime="2024-02-03T00:00:00.000Z" itemprop="datePublished">2024-02-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/justsay/">justsay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/03/immersion/index/">沉浸感</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>我很喜欢玩赛博朋克2077，在往日之影发布之前很久已经清完了所有的支线和委托。往日之影发布之后，我熬了两个晚上，玩完了全部四个分支。</p>
<p>随后我就出去旅游了。往日之影的结局是在是太让我感到无力了，那个时候我就坐在酒店的阳台上发呆。为什么会这样啊，我很难过。与其这样生活，真的不如再活半年，或者把身体留给强尼，至少这样不会失去朋友啊。</p>
<p>人们总是很容易把艺术作品中的情形代入到自己的生活中，或者反之。</p>
<p>那个时候我在日记里写道</p>
<blockquote>
<p>这也像极了现在的我。我在一点点失去我的朋友，我找不到生活的目标，这样的生活，远远不如以前开心。可生活不是游戏，没办法轻松重新选择故事走向。每次重新选择，都要承担巨大的代价和后果。</p>
</blockquote>
<hr>
<p>在赛博朋克之后，我再也没有精力去如此品玩任何其他的游戏。可能是怕试错成本太高，很难找到符合我的喜好的游戏。Game Pass Ultimate过期之后也没有再续费，因为感觉自己完全找不到能玩的游戏。</p>
<p>在影视作品中，我有些时候也会有这种感觉。</p>
<p>最近白嫖了 Apple TV+，然后熬了三四个晚上看完了灵异女仆。 电视剧的节奏挺慢的，至少说在惊悚悬疑题材里这个节奏很慢，还好我没有追剧。</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/01/2024013122284421-scaled.jpg"><img src="/images/2024013122284421-scaled.jpg"></a></p>
<p>我很喜欢女主Leanne的人设和演员的演绎，Leanne只不过是童年破碎的受害者，她把自己对亲生母亲的期望全部投射到Dorothy身上。 男主一家人里如果有一个人能稍微正常点，那么结局会不会好一点？ 只有厨师小弟对 Leanne 很好，没有理由也没有利益的羁绊，只是可惜那场约会永远也不会到来……</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/02/2024020605495956-scaled.jpg"><img src="/images/2024020605495956-scaled.jpg"></a></p>
<hr>
<p>哎所以我总是很怕这样。一方面是怕自己陷得太深，另一方面是怕自己以后很难发现更好的文艺作品。</p>
<p>我毫不犹豫的熬夜，只是想把自己沉浸在这些作品所营造的背景和氛围之内，这样我就可以暂时忘记发生在现实生活中的种种烦恼与问题，这样我就可以忽略问题，像鸵鸟一样把头埋在沙子里。 然而一旦看完这部电影，玩通那个游戏，这样的沙子也就不复存在，也就只能面对现实和无奈。🤷</p>
<p>有时候可能看看爽剧，玩一玩那些无脑爽游戏（比如最近几年的使命召唤），只是娱乐放松而没有沉浸，这样可能会对我的心理状态有更好的帮助。沉浸感太强，有的时候可能也不是一件好事🫠</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/03/immersion/index/" data-id="clyujt8au00025yjfb1atdv1w" data-title="沉浸感" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-end/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/31/2023-end/index/" class="article-date">
  <time class="dt-published" datetime="2023-12-31T00:00:00.000Z" itemprop="datePublished">2023-12-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/justsay/">justsay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/31/2023-end/index/">2023 年终总结</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>很多年没有写年终总结了。有很多事情都是2022年年底的发生的，四舍五入也算2023年的吧！</p>
<h2 id="博客"><a href="#博客" class="headerlink" title="博客"></a>博客</h2><p>2023年一共写了16篇博文，从数量上看起来比较少，从质量上看则更是堪忧🙃️</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/12/2023122902195115.png"><img src="/images/2023122902195115.png"></a></p>
<p>这一年学习到了很多有用没用的知识。</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/stripe-telegram.html">如何使用 Stripe API</a> ，应用到了 WebP Cloud Services 上</p>
</li>
<li><p>meilisearch，<a target="_blank" rel="noopener" href="https://dmesg.app/meilisearch.html">一个轻量级的全文搜索引擎</a>，支持CJK，正好拿来给 <a target="_blank" rel="noopener" href="https://dmesg.app/telegram-cjk-search.html">SearchGram</a> 用</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/graylog-geo-ip.html">学习配置了一下 Graylog</a>。是挺炫酷，但是从来不看，现在已经被我删掉了</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/cloudflare">学习使用 Cloudflare Zero Trust</a>中的一些组件。其实我是一周左右就弄懂了，但是故意隔开几天发博客</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/lede-shadowtls.html">在 LEDE&#x2F;OpenWRT 上使用ShadowTLS</a>，由于我用的是cnroute，所以打环了需要额外配置一下</p>
</li>
</ul>
<p>在这之后，我的博客就停更了差不多半年左右。这半年里我和 <a target="_blank" rel="noopener" href="https://github.com/n0vad3v">Nova</a> 还有 <a target="_blank" rel="noopener" href="https://github.com/tukideng">Tuki</a> 开发并运营了 **<a target="_blank" rel="noopener" href="https://webp.se/">WebP Cloud Services</a>**。这个想法来自于3年前的WebP Server Go，区别是Cloud Services功能更多更强大，而且是托管的SaaS服务。</p>
<p>这半年里我也写了博文，只不过放在了 <a target="_blank" rel="noopener" href="https://blog.webp.se/">WebP Cloud Services Blog</a> 上。为了增加受众，并且我们的目标是出海，我们还用 ChatGPT 翻译了英文版本的。</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://blog.webp.se/golang-libvips-cgo-zh/">libvips, cgo, purego</a> 切换到 libvips 之后我们一直希望能够实现交叉编译（静态链接就别想了，这永远只是一个梦），然而，即便交叉编译，那也是梦里才有的事情……</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.webp.se/govips-filter-zh/">使用 libvips 实现CSS滤镜</a>，看了 W3C的文档，学会了如何做渐变，甚至还学习了一些高等数学的知识</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.webp.se/cve-2023-4863-fix-zh/">手动编译了一下 libwebp</a>，啥也没学会，只听见电表起飞的声音</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.webp.se/change-loglevel-runtime-zh/">在运行时通过UNIX 信号 修改loglevel</a>，UNIX哲学。不过，这个过程中我写出来了一个 bug，会<a target="_blank" rel="noopener" href="https://blog.webp.se/goroutine-leak-zh/">导致goroutine泄漏</a>，然后CPU使用率缓慢升高。哎，有时还是不能太相信AI啊。</p>
</li>
</ul>
<p>然后，我就又回到了🥔不好吃</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/es-ee-se-unicode.html">西班牙、爱沙尼亚吞并了瑞典的故事</a>，unicode真是太神奇且深奥啦</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/steam-deck-stuck.html">steam deck 游戏卡logo</a>，从 steam community翻到了然后抄过来的🤣</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/nodejs-dual-stack.html">Nodejs 双栈协议踩坑</a>，nodejs 真™️™️的草台班子。和JavaScript一样草台</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/tron-trx.html">Tron（TRX）收款</a>，本王终于进入币圈了，学习了 HD钱包的原理，给 go <a target="_blank" rel="noopener" href="https://github.com/ranjbar-dev/tron-wallet">tron-wallet</a> 贡献了代码。 WebP Cloud Services 也支持通过 TRX 付款啦💰</p>
</li>
</ul>
<p>这一年的写作到这里就结束了。</p>
<h2 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h2><p>换了一份工作，薪水比上份工作多一些。然而我觉得这份工作并没有上一份工作那么令我满意，主要集中在以下这几点吧：</p>
<ul>
<li><p>工作流程：上一份工作的公司刚刚被某芯片大厂收购，工作流程非常规范（因此也很慢），任何变更要通过 PR来，需要2个 review，Test Coverage大概有个70-80%左右</p>
</li>
<li><p>技术栈的变化：前司是Python + Clarity + PostgreSQL，我还接手了一个 Java的Play framework 的东西，感谢老板对我的信任，我都没想到能弄明白🤣 现在则是 Nodejs + Angular+ Elm 。JavaScript 懂得都懂黑点无数，大家也乐此不疲的黑JS，但是无论怎么说JS还是发展非常迅速的一门语言，生态也挺不错。Elm那我只能😄啦，只提一点：标准库上次更新是2021年2月。</p>
</li>
<li><p>氛围和企业文化：这个没什么可说的，都很棒，同事们都挺好的。也没有什么996的事，到点就走。但是不知为何我还是更喜欢前司😂</p>
</li>
</ul>
<p>别的倒也没什么，俗话说钱难挣嘛，这个道理都懂……</p>
<h2 id="旅游"><a href="#旅游" class="headerlink" title="旅游"></a>旅游</h2><p>从来不爱旅游的我，今年竟然破天荒的去了5个城市旅游。收获了什么忘记了，无论是「这个楼也太他妈牛逼了」还是「落霞与孤鹜齐飞」都不记得了。 我也没写xxx游记，只记得买了很多明信片😓</p>
<h2 id="开源项目"><a href="#开源项目" class="headerlink" title="开源项目"></a>开源项目</h2><ul>
<li><p>YYeTs：基本没什么太大的变化，dependabot的commit比我还多。前段时间转手给别人之后我更是不管了</p>
</li>
<li><p>WebP Server Go：虽然有持续的更新，并且有一些 issue，但是主要都是 Nova 大佬在处理，我基本打酱油了</p>
</li>
<li><p>ytdlbot：更新了一大堆东西，每天跑 200G 流量。收获0.</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/12/202312290332433.png"><img src="/images/202312290332433.png"></a></p>
<p>总体来看，基本上可以说还是那些，没什么新的变化，“僵尸”状态可能是一个比较恰当的形容词。</p>
<h2 id="游戏"><a href="#游戏" class="headerlink" title="游戏"></a>游戏</h2><p>电子阳痿。</p>
<p>等了很久的《往日之影》发布了，熬夜两天玩完，后劲太大直接让我郁闷的好几天。假如我是V，我会怎样做出选择？接受治疗活下去，然后失去一切。真的是一切都变了，物是人非，曾经的V震天甚至还会被街边的小混混揍，而这只是短短的两年。</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/12/2023122903214866.png"><img src="/images/2023122903214866.png"></a></p>
<p>曾经的V可是这样的啊（这套服装是往日之影里那个法国黑客奥罗尔的复刻，还蛮好看的，我好喜欢。这把刀好像叫爪磨？）</p>
<p>与其这样生活，真的不如再活半年，或者把身体留给强尼。甚至，不如信了荒坂。</p>
<p>人呐难免会把艺术作品中的事情联想到自己身上，这个高塔结局说的不就是现在的我吗？</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/12/2023123001413713-scaled.jpeg"><img src="/images/2023123001413713-scaled.jpeg"></a></p>
<h3 id="Steam-Deck"><a href="#Steam-Deck" class="headerlink" title="Steam Deck"></a>Steam Deck</h3><p>买了个 Steam Deck，淘了个显示器键盘和1 TB SSD，然后装了个双系统。这玩意就是一个标准的x86机器，所以装双系统甚至三系统这种事情对于我来说自然不在话下。惊叹于 Windows 11，和Windows 10比起来还是变化了很多的。</p>
<p>装完系统我也没怎么用，看起来也电子阳痿了。</p>
<h2 id="影视作品"><a href="#影视作品" class="headerlink" title="影视作品"></a>影视作品</h2><p>看了挺多，大部分都是 Netflix上的</p>
<ul>
<li><p>VIVANT： 堺雅人主演的电视剧，前几集挺好看，后面略差。堺雅人的英文不太好，可能不如中文吧</p>
</li>
<li><p>石子和羽男 ：有村架纯真的是太可爱了，我好爱她😍</p>
</li>
<li><p>V世代：黑袍纠察队的衍生电视剧，很不错</p>
</li>
<li><p>上载新生第三季：略差了，但是比第二季好多了</p>
</li>
<li><p>最后生还者：改编于同名游戏，那个被魔山捏爆脑子的王子还真是挺忙</p>
</li>
<li><p>曼达洛人第三季：电视剧总体水平还不错，但是不知道为何我不太喜欢了，可能毕竟不是星战粉吧。主演还是上面那个王子</p>
</li>
<li><p>阿妮亚传奇啊不，间谍过家家：我很少看动漫，但是这部动漫竟然坚持下来了</p>
</li>
<li><p>赛博朋克 边缘行者：听说看完这部动漫的人都打开游戏锤爆亚当·重锤，我也不例外😂</p>
</li>
<li><p>噬亡村：柳乐优弥和吉冈里帆主演的电视剧。吉冈妹子真的好美，不知道第二季什么时候，这都快一年了</p>
</li>
<li><p>弥留之国的爱丽丝：第二季不太行……</p>
</li>
<li><p>甜蜜家园第二季：更不行</p>
</li>
<li><p>谁是被害者：台剧，还不错嗷</p>
</li>
<li><p>模仿犯：也是台剧，不错</p>
</li>
<li><p>罪后真相：台湾电影，还好，看预告片不错</p>
</li>
<li><p>黑暗荣耀：宋慧乔主演的，不错</p>
</li>
<li><p>黑镜第六季：琼糟透了、海之彼岸还不错，其他的一般般</p>
</li>
<li><p>关注者：不知道讲了什么，全程被池田 エライザ吸引🤩</p>
</li>
<li><p>初恋：这年头的纯爱剧，还真的能看进去（其中有一点点18🈲️镜头哈哈哈），主题曲和灵感均是宇多田光的 First Love，光妹真的浑身发光啊</p>
</li>
<li><p>重启人生：假如我能重启人生，那么我要做的事情会不会是，在高考结束之后的那天，把上交的志愿改掉？</p>
</li>
</ul>
<p>还有一堆乱七八糟的，不记得了想不起来了</p>
<h2 id="音乐"><a href="#音乐" class="headerlink" title="音乐"></a>音乐</h2><p>新增了很多 OST，都是赛博朋克的，最喜欢的还是 <a target="_blank" rel="noopener" href="https://music.163.com/song?id=2083630443">Gate K9</a>（往日之影）和 <a target="_blank" rel="noopener" href="https://music.163.com/song?id=1804292550">The Rebel Path</a>（单挑荒坂塔）</p>
<p>剩下的歌曲基本都是日本流行乐，基本全是 uru，我最喜欢的可能是 「ドライフラワー 」吧，这种小小伤感的歌曲最让我喜欢了：</p>
<ul>
<li><p>なんでもないよ</p>
</li>
<li><p>ドライフラワー</p>
</li>
<li><p>無機質</p>
</li>
<li><p>恋</p>
</li>
<li><p>再会</p>
</li>
<li><p>ポジティ部入部</p>
</li>
<li><p>ランドマーク</p>
</li>
<li><p>紙一重</p>
</li>
<li><p>君の幸せを</p>
</li>
<li><p>セレナーデ</p>
</li>
</ul>
<h2 id="猫"><a href="#猫" class="headerlink" title="猫"></a>猫</h2><p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/12/2023122903434288.jpg"><img src="/images/2023122903434288.jpg"></a></p>
<p>还是挺恩爱的。但是酸奶后背脱毛了😫，并且从昨天开始呕吐腹泻😫😫😫</p>
<h2 id="期待"><a href="#期待" class="headerlink" title="期待"></a>期待</h2><p>希望酸奶早日好起来，猫咪身体健康。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/12/31/2023-end/index/" data-id="clqxhsve30000w1qr2oac5v4z" data-title="2023 年终总结" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-tron-trx/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/09/tron-trx/index/" class="article-date">
  <time class="dt-published" datetime="2023-12-09T00:00:00.000Z" itemprop="datePublished">2023-12-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/what/">what</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/09/tron-trx/index/">使用 Tron(TRX) 收款</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>今年年初的时候，我写过<a target="_blank" rel="noopener" href="https://dmesg.app/stripe-telegram.html">如何用 Stripe 收款</a>。但是 Stripe 的注册门槛确实要高一些，这一点就足够劝退很多人了。</p>
<p>退而求其次，用加密货币来收款也是可以的。区块链上所有的交易都是公开的，因此我们可以通过这一点来验证用户的付款情况。</p>
<p>想要验证用户付款，包括但不限于如下方式：</p>
<ul>
<li>每笔交易都生成一对密钥，对应一个付款地址。密钥管理会非常麻烦</li>
<li>有些交易可以添加一个描述字段，用于区分。像极了给对公账户转账时的OCR&#x2F;Reference</li>
<li>尾数标记，略微改变付款金额，比如同样需要付款1 USDT，可以一个用户需要付款1.000001另外一个需要付款1.000002</li>
</ul>
<p>前几天了解到 HD 钱包（高清钱包 分层确定性钱包 Hierarchical Deterministic Wallet），发现这种技术非常有趣。它允许通过单个种子源生成一整套密钥对（即公钥和私钥），像树形结构一样。有一个根，就可以计算出树上任意一个节点的公私钥。</p>
<p>那这就刚刚好，每一笔交易我都给树上增加一个叶子节点，只要有根和路径，就可以计算出这个节点的公私钥。</p>
<p>这里我选择 Tron的TRX，主要原因还是转账手续费比较低😂</p>
<h2 id="钱包路径"><a href="#钱包路径" class="headerlink" title="钱包路径"></a>钱包路径</h2><p>从树根走到某一个叶子，肯定要一个特定的路径的。对于 tron来说，一个典型的路径是这样的</p>
<p><strong>m&#x2F;44’&#x2F;195’&#x2F;0’&#x2F;0&#x2F;0</strong></p>
<ul>
<li><strong>m&#x2F;44</strong>表示BIP44标准</li>
<li><strong>195</strong>表示 TRON，每种加密货币都分配有一个唯一的编号</li>
<li>**0’**表示钱包的第一个账户，创建多个账户那就是1‘ 2’</li>
<li><strong>0</strong> 链接层级 一般0表示接收 1表示找零</li>
<li><strong>0</strong> 特定地址索引，改变这个数字就会生成新的地址</li>
</ul>
<p>由于我们想每一笔交易都生成不同的地址，那么我们可以这样设想</p>
<ul>
<li><strong>m&#x2F;44’&#x2F;195’&#x2F;0’&#x2F;0&#x2F;0</strong> 这个路径用于保存所有的余额</li>
<li><strong>m&#x2F;44’&#x2F;195’&#x2F;1’&#x2F;0&#x2F;(0-10000)</strong> 每一笔交易请求都通过1钱包的不同索引生成不同地址</li>
<li>每一笔交易确认后，都计算出这个地址的私钥，然后把钱转到0账户中</li>
</ul>
<h2 id="库"><a href="#库" class="headerlink" title="库"></a>库</h2><p>Python 中有很多库可以处理加密货币。比如 <a target="_blank" rel="noopener" href="https://github.com/meherett/python-hdwallet">python-hdwallet</a> 实现了一百多种货币的HD钱包；我们本次的目的非常简单，只使用 TRON，那么就用 <a target="_blank" rel="noopener" href="https://github.com/andelf/tronpy">tronpy</a> 好了</p>
<h2 id="生成助记词"><a href="#生成助记词" class="headerlink" title="生成助记词"></a>生成助记词</h2><p>[v_tips]mnemonic, m不发音[&#x2F;v_tips] 这个助记词也就是所谓的根密钥，可以拿来生成下面任意节点的密钥。可不能泄漏出去，要不然所有的节点的密钥都可以被推断出来。</p>
<p>from tronpy.hdwallet import generate_mnemonic<br>m &#x3D; generate_mnemonic(12, “english”)<br>print(m)</p>
<h2 id="连接区块链网络"><a href="#连接区块链网络" class="headerlink" title="连接区块链网络"></a>连接区块链网络</h2><p>TRON 有如下几个网络：</p>
<ul>
<li>mainnet 主网，里面的钱是具有经济价值的，意味着可以兑换法币</li>
<li>shasta、nile 测试网，里面的钱没经济价值，完全测试用</li>
</ul>
<p><strong>由于不同国家和地区对于加密货币的法律政策限制不同</strong>，同时我并不想真正的去花钱，那么测试网就是再好不过的了。</p>
<p>from tronpy import Tron</p>
<p>MNEMONIC &#x3D; “slogan reduce clap umbrella liquid crumble outer exchange quiz promote owner buffalo”<br>client &#x3D; Tron(network&#x3D;”nile”)<br>addr &#x3D; client.generate_address_from_mnemonic(MNEMONIC, “”, “m&#x2F;44’&#x2F;195’&#x2F;0’&#x2F;0&#x2F;0”)<br>print(addr[“base58check_address”])</p>
<p>输出如下</p>
<p>TERbSCnpFp4FG6SLpUHpFRBRT69ZhHbLFp</p>
<p>你看我们这里使用了 account path，这个<code>0&#39;/0/0</code>就是我们最终集资的钱包</p>
<h2 id="为每笔交易生成收款地址"><a href="#为每笔交易生成收款地址" class="headerlink" title="为每笔交易生成收款地址"></a>为每笔交易生成收款地址</h2><p>我们使用 1’账户，然后需要在数据库中记录下索引，每笔交易都要生成不同的索引，自增就可以了，要记住这个索引，否则就没办法生成私钥了</p>
<p>addr &#x3D; client.generate_address_from_mnemonic(MNEMONIC, “”, “m&#x2F;44’&#x2F;195’&#x2F;1’&#x2F;0&#x2F;1”)<br>print(addr[“base58check_address”])</p>
<p>输出如下，这个地址就是用户要打钱的地方</p>
<p>TD2g6siz3NP4wcjP5iAueW9tottaAgP98a</p>
<h2 id="模拟用户"><a href="#模拟用户" class="headerlink" title="模拟用户"></a>模拟用户</h2><p>模拟用户付钱，那么就要先弄到一个有数字货币的钱包地址。可是这又是测试网，没办法真正兑换法币的。不慌，有网站可以免费领用于测试的币，如： <a target="_blank" rel="noopener" href="https://nileex.io/join/getJoinPage">https://nileex.io/join/getJoinPage</a></p>
<p>同样生成一个地址，记住地址和私钥，然后页面提交就好了。</p>
<p>为了方便实用，我们可以封装一个简单的命令行小程序</p>
<h2 id="付款"><a href="#付款" class="headerlink" title="付款"></a>付款</h2><p>client.trx.transfer(from_, to, amount).build().inspect().sign(priv).broadcast()<br>print(t.wait())</p>
<p><code>amount</code>是金额，<code>1_000_000</code> 是 1 TRX</p>
<p><code>priv</code> 是私钥，如果通过助记词和路径生成key，可以使用如下代码</p>
<p>def mnemonic_to_private_key():<br>    seed &#x3D; seed_from_mnemonic(mnemonic, passphrase&#x3D;””)<br>    private_key &#x3D; key_from_seed(seed, account_path&#x3D;”m&#x2F;44’&#x2F;195’&#x2F;0’&#x2F;0&#x2F;0”)<br>    return PrivateKey(private_key)</p>
<h2 id="验证付款"><a href="#验证付款" class="headerlink" title="验证付款"></a>验证付款</h2><p>简单的轮询即可</p>
<p># 获取地址信息<br>client.get_account(“TD2g6siz3NP4wcjP5iAueW9tottaAgP98a”)<br>获取地址余额，返回值类型是 Decimal 避免出现 0.1 + 0.2 &#x3D; 0.30000000000000004 的悲剧<br>client.get_account_balance(“TD2g6siz3NP4wcjP5iAueW9tottaAgP98a”)</p>
<h2 id="验证成功后转钱到集中地址"><a href="#验证成功后转钱到集中地址" class="headerlink" title="验证成功后转钱到集中地址"></a>验证成功后转钱到集中地址</h2><p>和付款一样，把 To 改成自己的地址就好。如果你想也可以弄成交易所给的地址、或者本地钱包软件给的地址。</p>
<p>在转账失败时，应该把金额减少 1.1 TRX用于付矿工费</p>
<h2 id="使用-Telegram-Bot处理"><a href="#使用-Telegram-Bot处理" class="headerlink" title="使用 Telegram Bot处理"></a>使用 Telegram Bot处理</h2><p>理解了以上所有步骤之后，简单封装一下就可以了，下面是一组示例代码，使用 apscheduler 轮询获取付款状态。简单起见没有引入数据库，正常要用起来的话，还是要把一些关键的信息，如付款地址、路径等写入到数据库中的。</p>
<p>import logging</p>
<p>import telebot<br>from apscheduler.schedulers.background import BackgroundScheduler<br>from telebot.types import Message<br>from tronpy import Tron<br>from tronpy.exceptions import TransactionError, ValidationError<br>from tronpy.hdwallet import key_from_seed, seed_from_mnemonic<br>from tronpy.keys import PrivateKey</p>
<p>logging.basicConfig(level&#x3D;logging.INFO)<br>bot &#x3D; telebot.TeleBot(“12345”)</p>
<p>index &#x3D; 0</p>
<h1 id="address-user-id-123-path-“m-x2F-44’-x2F-195’-x2F-1’-x2F-0-x2F-0”"><a href="#address-user-id-123-path-“m-x2F-44’-x2F-195’-x2F-1’-x2F-0-x2F-0”" class="headerlink" title="address: {user_id: 123, path: “m&#x2F;44’&#x2F;195’&#x2F;1’&#x2F;0&#x2F;0”"></a>address: {user_id: 123, path: “m&#x2F;44’&#x2F;195’&#x2F;1’&#x2F;0&#x2F;0”</h1><p>unpaid_map &#x3D; {}</p>
<p>mnemonic &#x3D; “slogan reduce clap umbrella liquid crumble outer exchange quiz promote owner buffalo”</p>
<p>class TronTrx:<br>    def __init__(self):<br>        self.client &#x3D; Tron(network&#x3D;”nile”)<br>        self.central &#x3D; “m&#x2F;44’&#x2F;195’&#x2F;0’&#x2F;0&#x2F;0”</p>
<pre><code>def mnemonic\_to\_private\_key(self, path):
    seed = seed\_from\_mnemonic(mnemonic, passphrase=&quot;&quot;)
    private\_key = key\_from\_seed(seed, account\_path=path)
    return PrivateKey(private\_key)

def central\_wallet(self):
    return self.client.generate\_address\_from\_mnemonic(mnemonic, &quot;&quot;, self.central)\[&quot;base58check\_address&quot;\]

def generate\_address(self, user\_id):
    global index
    path = f&quot;m/44&#39;/195&#39;/1&#39;/0/&#123;index&#125;&quot;
    logging.info(&quot;Generating address for user %s with path %s&quot;, user\_id, path)
    addr = self.client.generate\_address\_from\_mnemonic(mnemonic, &quot;&quot;, path)\[&quot;base58check\_address&quot;\]
    unpaid\_map\[addr\] = &#123;&quot;user\_id&quot;: user\_id, &quot;path&quot;: path&#125;
    index += 1
    return addr

def transfer(self, from\_: str, to: str, amount: int):
    logging.info(&quot;Transfer %s TRX from %s to %s&quot;, amount, from\_, to)
    from\_path = unpaid\_map\[from\_\]\[&quot;path&quot;\]
    try:
        (
            self.client.trx.transfer(from\_, to, amount)
            .build()
            .sign(self.mnemonic\_to\_private\_key(from\_path))
            .broadcast()
        )
    except (TransactionError, ValidationError):
        logging.warning(&quot;Balance not enough, try to transfer %s TRX&quot;, amount - 1\_100\_000)
        (
            self.client.trx.transfer(from\_, to, amount - 1\_100\_000)
            .build()
            .sign(self.mnemonic\_to\_private\_key(from\_path))
            .broadcast()
        )

def verify\_payment(self):
    logging.info(&quot;Checking %s unpaid payment&quot;, len(unpaid\_map))
    for addr, meta in unpaid\_map.items():
        try:
            balance = self.client.get\_account\_balance(addr)
        except:
            balance = 0
        if balance:
            logging.info(&quot;addr %s has %s TRX&quot;, addr, balance)
            self.transfer(addr, self.central\_wallet(), int(balance \* 1\_000\_000))
            bot.send\_message(meta\[&quot;user\_id&quot;\], f&quot;You have paid &#123;balance&#125; TRX&quot;)
            del unpaid\_map.copy()\[addr\]
</code></pre>
<p>trx &#x3D; TronTrx()</p>
<p>@bot.message_handler(commands&#x3D;[“pay”])<br>def send_address(message: Message):<br>    bot.send_message(message.chat.id, trx.generate_address(message.chat.id))</p>
<p>@bot.message_handler(commands&#x3D;[“start”])<br>def send_start(message: Message):<br>    bot.send_message(message.chat.id, “hello”)</p>
<p>if __name__ &#x3D;&#x3D; “__main__“:<br>    scheduler &#x3D; BackgroundScheduler()<br>    scheduler.add_job(trx.verify_payment, “interval”, seconds&#x3D;10, max_instances&#x3D;1)<br>    scheduler.start()<br>    bot.infinity_polling()</p>
<p><img src="/images/2023120904562828.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/12/09/tron-trx/index/" data-id="clqxhsveu0005w1qr9o58cj7i" data-title="使用 Tron(TRX) 收款" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-nodejs-dual-stack/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/11/26/nodejs-dual-stack/index/" class="article-date">
  <time class="dt-published" datetime="2023-11-26T00:00:00.000Z" itemprop="datePublished">2023-11-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/11/26/nodejs-dual-stack/index/">Node.js 18升级：双栈协议踩坑</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>很久之前我就发现了一个现象，有些时候我在使用 nc去探测本地的某些服务是否开启时，会有两个输出，第一次拒绝第二次成功，输出如下所示：</p>
<p>$ nc -v localhost 12345</p>
<p>nc: connectx to localhost port 12345 (tcp) failed: Connection refused<br>Connection to localhost port 12345 [tcp&#x2F;italk] succeeded!</p>
<p>很奇怪，但是又不是不能用，就一直没去深究，甚至连一点点思考都没有。</p>
<p>前几天在把项目的 Node.js 从16升级到18时，突然发现能用 redbird 连不上后端的一个服务了。</p>
<p>于是我就继续 <code>nc</code> 了一下，使用 nc 是作为网络工程师的基本技能。结果输出和上面一样，第一次拒绝第二次成功。</p>
<p>想了几分钟突然懂了，我的服务只监听在了 IPv4的地址，并没有监听 IPv6的地址，而<code>localhost</code> 通常会同时解析为 IPv6的本地环回地址 <code>::1</code> 和 IPv4的<code>127.0.0.1</code> 。同时对于大部分应用程序而言，在双栈的情况下会优先尝试 IPv6，如果失败那么再回落到 IPv4.</p>
<p>$ ping localhost</p>
<p>PING localhost (127.0.0.1): 56 data bytes<br>64 bytes from 127.0.0.1: icmp_seq&#x3D;0 ttl&#x3D;64 time&#x3D;0.115 ms<br>^C<br>— localhost ping statistics —<br>1 packets transmitted, 1 packets received, 0.0% packet loss<br>round-trip min&#x2F;avg&#x2F;max&#x2F;stddev &#x3D; 0.115&#x2F;0.115&#x2F;0.115&#x2F;nan ms</p>
<p>benny@Yogurt ~<br>$ ping6 localhost<br>PING6(56&#x3D;40+8+8 bytes) ::1 –&gt; ::1<br>16 bytes from ::1, icmp_seq&#x3D;0 hlim&#x3D;64 time&#x3D;0.053 ms</p>
<p>当时也没多想，猜测就是 redbird 由于什么原因只尝试了 IPv6 的地址。那就简单点改 hosts 让 <code>localhost</code> 只解析到 <code>127.0.0.1</code>就好了。 [v_tips]可是我没有 IPv6地址呀？ 没关系，即便你没有被分配IPv6地址，只要没有明确禁用IPv6，如 net.ipv6.conf.all.disable_ipv6 &#x3D; 1 那么 ::1 等就是有的！ [&#x2F;v_tips]</p>
<p>这样改 hosts 确实管用，但是知其然，更要知其所以然……</p>
<p>在开始之前，我们需要了解几个概念</p>
<h2 id="127-0-0-1-与-1"><a href="#127-0-0-1-与-1" class="headerlink" title="127.0.0.1 与 ::1"></a>127.0.0.1 与 ::1</h2><p>为表示本地计算机所保留的IP地址，对于 IPv4而言，其范围是 <code>127.0.0.0/8</code>，其地址范围为 <code>127.0.0.0</code> ～ <code>127.255.255.255</code>，除去开头的0表示网络位和结尾255表示广播地址，其余所有地址都可以表示本机。</p>
<p>~: ping 127.255.255.254</p>
<p>PING 127.255.255.254 (127.255.255.254) 56(84) bytes of data.<br>64 bytes from 127.255.255.254: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;0.028 ms<br>^C<br>— 127.255.255.254 ping statistics —<br>1 packets transmitted, 1 received, 0% packet loss, time 0ms<br>rtt min&#x2F;avg&#x2F;max&#x2F;mdev &#x3D; 0.028&#x2F;0.028&#x2F;0.028&#x2F;0.000 ms</p>
<p>~: ping 127.8.9.2<br>PING 127.8.9.2 (127.8.9.2) 56(84) bytes of data.<br>64 bytes from 127.8.9.2: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;0.045 ms<br>64 bytes from 127.8.9.2: icmp_seq&#x3D;2 ttl&#x3D;64 time&#x3D;0.039 ms</p>
<p>至少在 Linux下是这样的！<code>127.0.0.1</code>是常用的标准环回地址，其他地址并不是所有操作系统都支持。</p>
<p>对于 IPv6 来说，事情就简单了，一个 <code>::1</code> 没有其他的花样。</p>
<p>如果我们的应用程序监听在 <code>127.0.0.1</code>，那么意味着只有本机，更准确的说来自于 <code>127.0.0.1</code> 的请求才会被接受；类似地，监听在 <code>::1</code> 也是一样，意味着只有来自 <code>::1</code> 的请求才会被接受。</p>
<p>我们可以使用 nc来做这样一个实验，k表示连接后不断开，l表示listen</p>
<p>nc -klv 127.0.0.1 12345</p>
<p>然后另开一个窗口 <code>nc -v 127.0.0.1 12345</code></p>
<p>$ nc -v 127.0.0.1 12345<br>Connection to 127.0.0.1 port 12345 [tcp&#x2F;italk] succeeded!<br>^C</p>
<p>benny@Yogurt: ~<br>$ nc -v ::1 12345<br>nc: connectx to ::1 port 12345 (tcp) failed: Connection refused</p>
<p>你看，虽然都是一台电脑，但是 <code>::1</code> 却不行，如果你有 docker，<code>docker0</code>网桥的地址是<code>172.17.0.1</code>，开个容器试试</p>
<p>~ # ping 172.17.0.1<br>PING 172.17.0.1 (172.17.0.1): 56 data bytes<br>64 bytes from 172.17.0.1: seq&#x3D;0 ttl&#x3D;64 time&#x3D;0.213 ms<br>^C<br>— 172.17.0.1 ping statistics —<br>1 packets transmitted, 1 packets received, 0% packet loss<br>round-trip min&#x2F;avg&#x2F;max &#x3D; 0.213&#x2F;0.213&#x2F;0.213 ms</p>
<p>~ # nc -vv 172.17.0.1 12345<br>nc: 172.17.0.1 (172.17.0.1:12345): Connection refused<br>sent 0, rcvd 0</p>
<p>也不行！因为请求不是从 127 来的而是172！如果想要从容器内可以访问，那么nc就要监听在网桥的地址，如 <code>nc -klv 172.17.0.1</code></p>
<p>[v_act]咱也不知道为啥要给loopback分配那么多地址，能把这些拿出来做其他的用途可能会更有趣。[&#x2F;v_act]</p>
<h2 id="0-0-0-0与"><a href="#0-0-0-0与" class="headerlink" title="0.0.0.0与 ::"></a>0.0.0.0与 ::</h2><p>[v_act]这里的 0.0.0.0 不是在指默认路由，指的是本机所有的 IPv4地址，:: 类似地指的是本机所有的IPv6 地址。[&#x2F;v_act]</p>
<p>当你的应用监听在 <code>0.0.0.0</code>时，所有的可达的IPv4地址都可以访问到。比如说，本机，docker 容器，你的路由器等等都可以。我们可以试试看<code>nc -klv 0.0.0.0 12345</code></p>
<h3 id="从MacBook连到-PVE-的虚拟机"><a href="#从MacBook连到-PVE-的虚拟机" class="headerlink" title="从MacBook连到 PVE 的虚拟机"></a>从MacBook连到 PVE 的虚拟机</h3><p>[18:17:02] benny:~ $ nc -v 192.168.7.55 12345<br>Connection to 192.168.7.55 port 12345 [tcp&#x2F;italk] succeeded!</p>
<h3 id="从PVE的虚拟机的容器连网桥"><a href="#从PVE的虚拟机的容器连网桥" class="headerlink" title="从PVE的虚拟机的容器连网桥"></a>从PVE的虚拟机的容器连网桥</h3><p>~ # cat &#x2F;etc&#x2F;issue<br>Welcome to Alpine Linux 3.18<br>Kernel \r on an \m (\l)</p>
<p>~ # nc -v 172.17.0.1 12345<br>172.17.0.1 (172.17.0.1:12345) open</p>
<p>噢！有一点需要注意，如果你是 macOS或者Windows的话，由于这两者并不原生支持 docker，所以他们的docker实际上是跑在虚拟机里的。此时你 <code>nc -v 172.17.0.1</code> 也是不行的，因为这里<code>172.17.0.1</code> 代表的是虚拟机的网桥，而不是你的电脑的网桥。此时你需要 <code>host.docker.internal</code>这个内部域名。 [v_blue]Windows 的话，具体情况我没测试，因为有 Hyper V和WSL两种情况。[&#x2F;v_blue]</p>
<h3 id="如果此时我们在本机通过-1-尝试连接"><a href="#如果此时我们在本机通过-1-尝试连接" class="headerlink" title="如果此时我们在本机通过 ::1 尝试连接"></a>如果此时我们在本机通过 <code>::1</code> 尝试连接</h3><p>~ ➤ nc -v ::1 12345<br>nc: connectx to ::1 port 12345 (tcp) failed: Connection refused</p>
<p>当然不行了，nc都明确指明只监听 IPv4的，那么通过v6自然连不上</p>
<p> </p>
<p>那么我们如果指定 nc 只监听 IPv6，那么是不是 <code>nc -v 127.0.0.1 12345</code> 就不行了呢？</p>
<p>nc -klv :: 12345</p>
<p>再开一个新窗口</p>
<p>~ ➤ nc -v 127.0.0.1 12345<br>Connection to 127.0.0.1 port 12345 [tcp&#x2F;italk] succeeded!<br>^C</p>
<p>~ ➤ nc -v ::1 12345<br>Connection to ::1 port 12345 [tcp&#x2F;italk] succeeded!</p>
<p>啊，竟然都可以，意味着无论是IPv4还是IPv6都可以连接！</p>
<p>[v_blue]nc -klv localhost 12345 呢？这取决于 localhost 的解析结果[&#x2F;v_blue]</p>
<p>这是为什么呢？</p>
<h2 id="net-ipv6-bindv6only"><a href="#net-ipv6-bindv6only" class="headerlink" title="net.ipv6.bindv6only"></a>net.ipv6.bindv6only</h2><p>这是 Linux 内核的一个参数，用于定义监听IPv6地址时的行为。默认情况下，这个值是0 禁用，也就意味着，如果你监听了<code>::</code> 那么也相当于监听了 <code>0.0.0.0</code></p>
<p>从 <code>netstat</code> 中我们可以看出</p>
<h3 id="如果是-的话"><a href="#如果是-的话" class="headerlink" title="如果是 :: 的话"></a>如果是 :: 的话</h3><p>tcp6 0 0 :::12345 :::* LISTEN 1925847&#x2F;nc</p>
<h3 id="如果是-0-0-0-0的话"><a href="#如果是-0-0-0-0的话" class="headerlink" title="如果是 0.0.0.0的话"></a>如果是 0.0.0.0的话</h3><p>tcp 0 0 0.0.0.0:12345 0.0.0.0:* LISTEN 1926110&#x2F;nc</p>
<h3 id="如果我们通过-sysctl-启用这个参数"><a href="#如果我们通过-sysctl-启用这个参数" class="headerlink" title="如果我们通过 sysctl 启用这个参数"></a>如果我们通过 <code>sysctl</code> 启用这个参数</h3><p>sysctl net.ipv6.bindv6only&#x3D;1</p>
<p>然后再次监听 <code>nc -klv :: 12345</code></p>
<p>再次通过 nc去连接 <code>127.0.0.1</code></p>
<p>nc -v 127.0.0.1 12345<br>nc: connect to 127.0.0.1 port 12345 (tcp) failed: Connection refused</p>
<p>就会发现连不上了，因为此时只监听 IPv6的地址，对于IPv4的对应端口并没有程序在监听。</p>
<p>在绝大多数 Linux 发行版中， <code>net.ipv6.bindv6only</code> 的默认值都是0，也就意味着监听在 <code>::</code> 也同样意味着监听在 <code>0.0.0.0</code> ；换句话说，在这种情况下，看到 <code>tcp6 :::port</code> 也就意味着通过 IPv4 也可以连接上。</p>
<p>macOS也同样有这样的行为，至于Windows嘛……可能也是，我没有Windows的机器来做测试。</p>
<h2 id="特殊情况"><a href="#特殊情况" class="headerlink" title="特殊情况"></a>特殊情况</h2><p>对于大多数应用程序，<code>localhost</code> 无非就是对应 <code>::1</code> 和或 <code>127.0.0.1</code> .但是MySQL是个例外，当你用 <code>localhost</code> 时，MySQL会通过 UNIX套接字（<code>/var/run/mysqld/mysqld.sock</code>） 去连接</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><ul>
<li>监听 <code>127.0.0.1</code> 意味着只有从 127来的请求可以接受，<code>::1</code> 同理</li>
<li>在大多数情况下 <code>net.ipv6.bindv6only=0</code>为默认值。 监听 <code>::</code> 同时意味着监听<code>0.0.0.0</code></li>
<li>在未明确禁用 IPv6的情况下，即便你没有IPv6 地址，那么大多数情况下 <code>localhost</code> 也会被 hosts定义到 <code>::1</code> 和 <code>127.0.0.1</code>；并且你也能监听在 <code>::</code></li>
<li>MySQL的localhost是套接字</li>
<li>如果同时解析到了IPv6和IPv4，那么应该优先 IPv6；如果IPv6连接失败，那么理想情况是应该回落到 IPv4，所谓“<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-cn/Happy_Eyeballs">快乐眼球（Happy eyeballs）</a>”算法</li>
</ul>
<hr>
<h2 id="Node-js-？？？"><a href="#Node-js-？？？" class="headerlink" title="Node.js ？？？"></a>Node.js ？？？</h2><p>你以为事情到这里就结束了吗？并没有。</p>
<p>明明应该支持快乐眼球算法的，但是后端只监听了 <code>0.0.0.0</code> 为什么 redbird的配置中写 <code>localhost</code>还是失败了呢？并且在使用 Node.js 16的时候没问题，18就有问题了。</p>
<h3 id="重新使用-nc-监听到-0-0-0-0"><a href="#重新使用-nc-监听到-0-0-0-0" class="headerlink" title="重新使用 nc 监听到 0.0.0.0"></a>重新使用 nc 监听到 <code>0.0.0.0</code></h3><p>nc -klv 0.0.0.0 12345</p>
<p>并且已经确认只有 IPv4可达，在 <code>nc -v localhost 12345</code> 时会先失败再成功</p>
<h3 id="使用如下简单的-Node-js-代码来测试"><a href="#使用如下简单的-Node-js-代码来测试" class="headerlink" title="使用如下简单的 Node.js 代码来测试"></a>使用如下简单的 Node.js 代码来测试</h3><p>const net &#x3D; require(“net”);<br>const client &#x3D; new net.Socket();<br>client.connect(12345, “localhost”, function () {<br>    client.write(`node js ${process.version}\n`);<br>    console.log(“Connected”);<br>    process.exit(0);<br>});</p>
<p><img src="/images/2023112603044820.jpeg" alt="图形用户界面, 文本, 应用程序, 电子邮件 描述已自动生成"></p>
<p>这是什么情况？</p>
<p><img src="/images/2023112603044973.png" alt="貓貓蟲咖波-開心隨你(上) - Download Stickers from Sigstick"></p>
<p>$ for i in {12..21}; do nvm use $i &amp;&amp; node test.js; done<br>Now using node v12.22.12 (npm v6.14.16)<br>Connected<br>Now using node v13.14.0 (npm v6.14.4)<br>Connected<br>Now using node v14.21.3 (npm v6.14.18)<br>Connected<br>Now using node v15.14.0 (npm v7.7.6)<br>Connected<br>Now using node v16.20.2 (npm v8.19.4)<br>Connected<br>Now using node v17.9.1 (npm v8.11.0)<br>node:events:505<br>      throw er; &#x2F;&#x2F; Unhandled ‘error’ event<br>      ^</p>
<p>Error: connect ECONNREFUSED ::1:12345<br>    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1195:16)<br>Emitted ‘error’ event on Socket instance at:<br>    at emitErrorNT (node:internal&#x2F;streams&#x2F;destroy:164:8)<br>    at emitErrorCloseNT (node:internal&#x2F;streams&#x2F;destroy:129:3)<br>    at processTicksAndRejections (node:internal&#x2F;process&#x2F;task_queues:83:21) {<br>  errno: -61,<br>  code: ‘ECONNREFUSED’,<br>  syscall: ‘connect’,<br>  address: ‘::1’,<br>  port: 12345<br>}</p>
<p>Node.js v17.9.1<br>Now using node v18.18.2 (npm v9.8.1)<br>node:events:495<br>      throw er; &#x2F;&#x2F; Unhandled ‘error’ event<br>      ^</p>
<p>Error: connect ECONNREFUSED ::1:12345<br>    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)<br>Emitted ‘error’ event on Socket instance at:<br>    at emitErrorNT (node:internal&#x2F;streams&#x2F;destroy:151:8)<br>    at emitErrorCloseNT (node:internal&#x2F;streams&#x2F;destroy:116:3)<br>    at process.processTicksAndRejections (node:internal&#x2F;process&#x2F;task_queues:82:21) {<br>  errno: -61,<br>  code: ‘ECONNREFUSED’,<br>  syscall: ‘connect’,<br>  address: ‘::1’,<br>  port: 12345<br>}</p>
<p>Node.js v18.18.2<br>Now using node v19.9.0 (npm v9.6.3)<br>node:events:491<br>      throw er; &#x2F;&#x2F; Unhandled ‘error’ event<br>      ^</p>
<p>Error: connect ECONNREFUSED ::1:12345<br>    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1532:16)<br>Emitted ‘error’ event on Socket instance at:<br>    at emitErrorNT (node:internal&#x2F;streams&#x2F;destroy:151:8)<br>    at emitErrorCloseNT (node:internal&#x2F;streams&#x2F;destroy:116:3)<br>    at process.processTicksAndRejections (node:internal&#x2F;process&#x2F;task_queues:82:21) {<br>  errno: -61,<br>  code: ‘ECONNREFUSED’,<br>  syscall: ‘connect’,<br>  address: ‘::1’,<br>  port: 12345<br>}</p>
<p>Node.js v19.9.0<br>Now using node v20.10.0 (npm v10.2.3)<br>Connected<br>Now using node v21.2.0 (npm v10.2.3)<br>Connected</p>
<p>咳，不过是Node.js自从17就弄坏了快乐眼球算法，18、19也是坏着的，直到20才修好。16之前的版本全是好的。</p>
<p>18是LTS啊，哎，这难免有点太<a target="_blank" rel="noopener" href="https://twitter.com/BennyThinks/status/1728062988765335859">草台班子</a>了吧。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://github.com/nodejs/node/issues/41625">https://github.com/nodejs/node/issues/41625</a> <a target="_blank" rel="noopener" href="https://github.com/nodejs/node/issues/40702">https://github.com/nodejs/node/issues/40702</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/11/26/nodejs-dual-stack/index/" data-id="clqxhsveg0002w1qr4j6o89d1" data-title="Node.js 18升级：双栈协议踩坑" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-steam-deck-stuck/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/11/25/steam-deck-stuck/index/" class="article-date">
  <time class="dt-published" datetime="2023-11-25T00:00:00.000Z" itemprop="datePublished">2023-11-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/it/">it</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/11/25/steam-deck-stuck/index/">Steam Deck 启动游戏卡 logo</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>最近买了个 Steam Deck，在玩游戏的时候发现一个很奇怪的bug。当休眠之后再次打开游戏，就会不停转 steam logo，如下图所示</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/11/2023111419033136.jpeg"><img src="/images/2023111419033136.jpeg"></a></p>
<p>但是如果按菜单键，会发现游戏已经加载成功了</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/11/2023111419033188.jpeg"><img src="/images/2023111419033188.jpeg"></a></p>
<p>重启之后可以解决，但是不能每次都重启啊。</p>
<p>后来发现，在 <strong>设置-自定义-用作唤醒影片</strong> 这个关掉就可以了 😂</p>
<p>这种 Bug 也是绝了😓</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a target="_blank" rel="noopener" href="https://steamcommunity.com/app/1675200/discussions/1/6348431004268742880/">https://steamcommunity.com/app/1675200/discussions/1/6348431004268742880/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/11/25/steam-deck-stuck/index/" data-id="clqxhsvet0003w1qr6tqg2y2l" data-title="Steam Deck 启动游戏卡 logo" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-es-ee-se-unicode/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/11/09/es-ee-se-unicode/index/" class="article-date">
  <time class="dt-published" datetime="2023-11-09T00:00:00.000Z" itemprop="datePublished">2023-11-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/11/09/es-ee-se-unicode/index/">Unicode编码之谜：为什么🇪🇸🇪🇪包含了🇸🇪？</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>如果你打开 Python console，输入如下代码</p>
<p>“🇸🇪” in “🇪🇸🇪🇪”</p>
<p>你会惊人的发现，结果是 <code>True</code>，同样的事情也发生在 JavaScript 中。</p>
<p><img src="/images/2023110902065099.png" alt="pasted-movie.png"></p>
<p>什么？</p>
<p>其实这一切都是Unicode的锅。</p>
<h2 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h2><p>Unicode是一种编码标准，它的目的是电脑能以通用划一的字符集来处理和显示文字，不但减轻在不同编码系统间切换和转换的困扰，更提供了一种跨平台的乱码问题解决方案。</p>
<p>简单的说，Unicode就是给世界上所有的文字符号都用一个唯一的编号替代。大家都用这一个编号，那么就能够显示一样的东西而不会错乱了。这个编号，被称作码位(code points)</p>
<h2 id="码位与字位"><a href="#码位与字位" class="headerlink" title="码位与字位"></a>码位与字位</h2><p>码位是什么上面已经解释了，字位（grapheme） 指的是最小的有意义的书写单位。比如 <code>😄</code> <code>卡</code> <code>ö</code> 这种都算一个字位，换句话说，人类认为是单个字符的东西，就是字位。</p>
<p>Unicode神奇的地方在于，字位可以由一个或者多个码位组成。</p>
<p>有的时候你能看到有些人的ID很长飘满整个屏幕，或者这种 ҈热҈得҈字҈都҈出҈汗҈了҈ 都是因为Unicode允许多个码位组成一个字位！</p>
<p>比如：</p>
<ul>
<li>💩的码位是 <code>U+1F4A9</code>，只有这一个</li>
<li>🇪🇸的码位是两个区域指示符，E和S <code>U+1F1EA</code> <code>U+1F1F8</code></li>
<li>🇪🇪的码位也是两个区指示符，E 和E <code>U+1F1EA</code> <code>U+1F1EA</code></li>
<li>🇸🇪也同理，S和E，U+1F1F8 U+1F1EA</li>
<li>👨‍👩‍👧‍👦 这个就恐怖了，它是这样的 👨ZWSP👩ZWSP👧ZWSP👦 男女男孩女孩+三个 零宽空格组成</li>
</ul>
<p>那么 <code>U+1F1EA U+1F1F8 U+1F1EA U+1F1EA</code> 是否包含<code>U+1F1F8 U+1F1EA</code> ？当然了！恰巧在中间呀。美国和厄瓜多尔也包含了瑞典。</p>
<h2 id="字符串的长度"><a href="#字符串的长度" class="headerlink" title="字符串的长度"></a>字符串的长度</h2><p>很多情况下我们需要判断字符串的长度，以确保他们不超过指定的范围。那么这个长度是怎么判定的？比如说对于这个恐怖字符 👨‍👩‍👧‍👦是算有多少个 code point，还是占用多少个字节，还是字位？</p>
<p>如果是多少个 code point，那么应该是4+3&#x3D;7；如果是多少字节，以UTF8为例，那么emoji 4字节，零宽3字节，4*4 + 3*3 &#x3D; 16 + 9 &#x3D;25字节</p>
<h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><p>&gt;&gt; len(“👨‍👩‍👧‍👦”)</p>
<blockquote>
<blockquote>
<p>7</p>
</blockquote>
</blockquote>
<h3 id="Go"><a href="#Go" class="headerlink" title="Go"></a>Go</h3><p>s :&#x3D; “👨‍👩‍👧‍👦”</p>
<p>fmt.Println(len(s))<br>fmt.Println(utf8.RuneCountInString(s))</p>
<p>输出分别为25 和 7</p>
<h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><p>“👨‍👩‍👧‍👦”.length<br>11</p>
<p>没错，JavaScript总是这样独树一帜。因为JavaScript是用UTF-16编码的啦。表情符号是2字节，零宽字符是1，4*2+3*1&#x3D;11</p>
<p>所以当你在计算最长多少个字符的时候，可要想好了对面是怎么算的。要不然很容易算错哦。</p>
<h2 id="循环字符串"><a href="#循环字符串" class="headerlink" title="循环字符串"></a>循环字符串</h2><p>所以循环字符串也要小心了……要不然就很容易会把emoji这种东西凭空劈开。比如说 Python里可以这样处理</p>
<p>import grapheme</p>
<p>s &#x3D; “👨‍👩‍👧‍👦🇸🇪🇨🇳”<br>for i in grapheme.graphemes(s):<br>    print(i)</p>
<p>这样就会依次打印三个emoji</p>
<p>或者使用语言对应的ICU，比如 PyICU等。</p>
<p>还有很多痛苦的事情等待你去发现😂</p>
<hr>
<p>所以，懂了如上道理的你，一定知道为什么 <strong>摩纳哥和荷兰包含了中国</strong> 了吧？不如打开小红书……</p>
<p><img src="/images/2023110902065097.png" alt="pasted-movie.png"></p>
<h2 id="参考阅读"><a href="#参考阅读" class="headerlink" title="参考阅读"></a>参考阅读</h2><p><a target="_blank" rel="noopener" href="https://blog.xinshijiededa.men/unicode/">https://blog.xinshijiededa.men/unicode/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/11/09/es-ee-se-unicode/index/" data-id="clqxhsvee0001w1qra4wkat0b" data-title="Unicode编码之谜：为什么🇪🇸🇪🇪包含了🇸🇪？" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-lede-shadowtls/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/05/25/lede-shadowtls/index/" class="article-date">
  <time class="dt-published" datetime="2023-05-25T00:00:00.000Z" itemprop="datePublished">2023-05-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/gfw/">gfw</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/05/25/lede-shadowtls/index/">在LEDE/OpenWRT上使用ShadowTLS</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>前几天我的Trojan连续被墙了两次。尽管Trojan装作自己是正常且普通的https流量，但还是中枪了。可能是因为最近日子比较难过，或者热门机房不明大量流量引起了怀疑</p>
<p>有一个比较类似的东西，叫ShadowTLS，也是用来伪装流量的，体验了一下感觉也不错。</p>
<p>ShadowTLS本身并不提供加密代理，所以我们往往还要配合一个Shadowsocks、vmess或者trojan之类的东西。也就是说，服务端要跑 ShadowTLS Server和Shadowsocks Server，客户端要跑ShadowTLS Client和Shadowsocks Client。当然，艺高人胆大的你也可以把shadowsocks替换成<code>nc</code>，なんでもないよ！</p>
<h2 id="服务端配置"><a href="#服务端配置" class="headerlink" title="服务端配置"></a>服务端配置</h2><p>以docker为例，直接参考<a target="_blank" rel="noopener" href="https://github.com/ihciah/shadow-tls/wiki/Run-with-Docker-Compose">官方wiki</a>改改就行了，需要注意的是这里必须要用host网络模式，因为要配置<code>ss-server</code>绑定到 ShadowTLS的地址（通常我们是监听到<code>0.0.0.0</code>），因此host模式最简单</p>
<p>version: ‘2.4’<br>services:<br>  shadowsocks:<br>    image: shadowsocks&#x2F;shadowsocks-libev<br>    restart: always<br>    network_mode: “host”<br>    environment:<br>      - SERVER_PORT&#x3D;24000<br>      - SERVER_ADDR&#x3D;127.0.0.1<br>      - METHOD&#x3D;aes-256-gcm<br>      - PASSWORD&#x3D;test-ss-password</p>
<p>  shadow-tls:<br>    image: ghcr.io&#x2F;ihciah&#x2F;shadow-tls:latest<br>    restart: always<br>    network_mode: “host”<br>    environment:<br>      - MODE&#x3D;server<br>      - LISTEN&#x3D;0.0.0.0:443<br>      - SERVER&#x3D;127.0.0.1:24000<br>      - TLS&#x3D;<a target="_blank" rel="noopener" href="http://www.microsoft.com:443/">www.microsoft.com:443</a><br>      - PASSWORD&#x3D;test-shadow-tls-password</p>
<ul>
<li><code>test-ss-password</code> ss客户端使用的密码，客户端使用ShadowTLS的监听端口443来连接</li>
<li><code>test-shadow-tls-password</code> ShadowTLS客户端使用的密码</li>
</ul>
<h2 id="Shadowrocket客户端配置"><a href="#Shadowrocket客户端配置" class="headerlink" title="Shadowrocket客户端配置"></a>Shadowrocket客户端配置</h2><p>如果你使用shadowrocket，那么就很简单了，正常配置，端口写ShadowTLS的443，插件-ShadowTLS，版本2，填入密码和host（本例<code>www.microsoft.com</code> ）</p>
<p><img src="/images/2023052503080949.jpeg" alt="图形用户界面, 文本, 应用程序, 电子邮件 描述已自动生成"></p>
<h2 id="手动配置客户端"><a href="#手动配置客户端" class="headerlink" title="手动配置客户端"></a>手动配置客户端</h2><p>shadow-tls-aarch64-apple-darwin client –server IP:443 –sni <a target="_blank" rel="noopener" href="http://www.microsoft.com/">www.microsoft.com</a> –password test-shadow-tls-password –listen 127.0.0.1:3443</p>
<p>sslocal -s localhost:3443 -m aes-256-gcm -k test-ss-password -b 127.0.0.1:17765</p>
<p>这样一波操作之后，你的 17765就是socks5了，ProxySwitchyOmega之类的配置一下就可以用了。</p>
<h2 id="docker-compose配置客户端"><a href="#docker-compose配置客户端" class="headerlink" title="docker-compose配置客户端"></a>docker-compose配置客户端</h2><p>这里没有必要host网络，<code>ss-local</code>连接到ShadowTLS的监听端口就可以，由于都在一个网络里，所以直接指定容器名tls就可以了。</p>
<p>version: ‘2.4’<br>services:<br>  shadow-tls:<br>    image: ghcr.io&#x2F;ihciah&#x2F;shadow-tls:latest<br>    restart: always<br>    environment:<br>      - MODE&#x3D;client<br>      - LISTEN&#x3D;0.0.0.0:3443<br>      - SERVER&#x3D;64.176.34.43:443<br>      - TLS&#x3D;<a target="_blank" rel="noopener" href="http://www.microsoft.com/">www.microsoft.com</a><br>      - PASSWORD&#x3D;test-shadow-tls-password</p>
<p>  shadowsocks:<br>    image: shadowsocks&#x2F;shadowsocks-libev<br>    restart: always<br>    command: ss-local -s shadow-tls -p 3443 -l 17765 -b 0.0.0.0 -k test-ss-password -m aes-256-gcm<br>    ports:<br>      - “127.0.0.1:17765:17765”</p>
<h2 id="LEDE-x2F-OpenWRT配置"><a href="#LEDE-x2F-OpenWRT配置" class="headerlink" title="LEDE&#x2F;OpenWRT配置"></a>LEDE&#x2F;OpenWRT配置</h2><p>基本和上面一样，也许已经有人做过插件了？反正也要先运行ShadowTLS</p>
<p><img src="/images/2023052503080929.png" alt="图形用户界面, 文本, 聊天或短信 描述已自动生成"></p>
<p>然后去LUCI中添加配置，ss服务器地址写<code>127.0.0.1</code>，端口写<code>3443</code>（ShadowTLS的端口）启动服务。这里有一个需要注意的点，如果你的运行模式是GFWlist，那么没问题；如果是全局或者chnroute（绕过大陆IP），那么就会打环。我一般喜欢用chnroute，两边的好处都占🙃️</p>
<p><img src="/images/2023052503081094.png" alt="图形用户界面, 应用程序 描述已自动生成"></p>
<p>此时要做的事情是添加一个例外，在我的这个插件里，是访问控制- WAN IP访问控制 -不走代理的WAN IP</p>
<p><img src="/images/2023052503081193.png" alt="图形用户界面, 应用程序, Teams 描述已自动生成"></p>
<p>其他的插件，比如passwall，也应该有类似的设置🫠</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/05/25/lede-shadowtls/index/" data-id="cli8jlcy00000g9qr9go2b3xa" data-title="在LEDE/OpenWRT上使用ShadowTLS" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-zero-trust-private-dns/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/05/01/zero-trust-private-dns/index/" class="article-date">
  <time class="dt-published" datetime="2023-05-01T00:00:00.000Z" itemprop="datePublished">2023-05-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cloudflare/">cloudflare</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/05/01/zero-trust-private-dns/index/">Cloudflare Zero Trust 添加私有解析DNS</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>很多公司，尤其是跨国大公司，会要求员工连接VPN（或者到办公室）来进入到一个10段的大内网。在这个内网内方能访问各种公司内部的资源，比如GitLab、Confluence、Jira之类的。</p>
<p>这种情况下就是做了私有DNS解析，这个解析记录并不会发布到公网上，就像你家路由器对于主机名为home这台设备的解析一样，只有进入了你家的网络才有。</p>
<p>在使用Cloudflare Zero Trust的情况下，我们也可以做到私有DNS解析，并且完全免费！使用Cloudflare Zero Trust，零成本的创建你的工作网络环境，如此简单！</p>
<h2 id="设置DNS服务器"><a href="#设置DNS服务器" class="headerlink" title="设置DNS服务器"></a>设置DNS服务器</h2><p>既然要设置私有DNS解析，那么毫无疑问需要设置一个由我们掌控的DNS服务器。简单起见，这里我直接在路由器上设置解析。如果你使用的也是LEDE&#x2F;OpenWRT，那么在 网络-DHCP&#x2F;DNS，最下面 「自定义域名挟持」中填入你的域名和解析到的IP地址。当然这个IPv4地址也可以写到公网IP，只不过这样有些搞笑🥸</p>
<p><img src="/images/2023042200381642.png" alt="图形用户界面, 应用程序 描述已自动生成"></p>
<p>添加保存之后，刷新一下本地的DNS缓存，就应该发现已经能ping通了</p>
<p><img src="/images/2023042200381753.png" alt="文本 描述已自动生成"></p>
<h2 id="注册WARP"><a href="#注册WARP" class="headerlink" title="注册WARP"></a>注册WARP</h2><p>具体可以参考这篇文章<a target="_blank" rel="noopener" href="https://dmesg.app/cf-zero-trust.html">《使用Cloudflare Zero Trust创建大内网》</a>，简单的说就是配置Cloudflared Tunnel、创建WARP设备注册权限、创建WARP Profile、选择Split Tunnel的模式，然后下载WARP认证连接。这里WARP就相当于公司给你安装的VPN了。</p>
<p>再提一下include和exclude这两种Split Tunnel的区别：</p>
<ul>
<li>Include：类似于WireGuard的<code>allowIP=192.168.7.0/24</code>, 其他非指定网段的流量会直接从你的网络出去，不走Cloudflare，可以理解成非全局VPN。此时你需要去include的规则中添加你的 <code>192.168.7.0/24</code></li>
<li>Exclude：所有流量都要走Cloudflare，类似全局VPN。此时你需要去exclude的规则中删除你的<code>192.168.7.0/24</code></li>
</ul>
<p>无论你是选择include还是exclude，确保连接WARP后，能够ping通内网的IP就可以进行下一步了。</p>
<h2 id="配置DNS-fallback"><a href="#配置DNS-fallback" class="headerlink" title="配置DNS fallback"></a>配置DNS fallback</h2><p>在Zero Trust网页上，进入到Profile配置页面，下拉能找到 Local Domain Fallback</p>
<p><img src="/images/2023042200381896.png" alt="图形用户界面, 应用程序, Teams 描述已自动生成"></p>
<p>点击Manage，左侧添加域名、DNS服务器和备注。这个DNS服务器就是上面配置好的那个。</p>
<p><img src="/images/2023042200381969.png" alt="图形用户界面, 文本, 应用程序 描述已自动生成"></p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="内网测试"><a href="#内网测试" class="headerlink" title="内网测试"></a>内网测试</h3><p>我现在连到了家里的网络，因此肯定能解析 <code>samba.dmesg.app</code> 这个域名的，此处没有任何问题</p>
<h3 id="外网测试"><a href="#外网测试" class="headerlink" title="外网测试"></a>外网测试</h3><p>手机开个热点，电脑连接上</p>
<p><img src="/images/2023042200382056.png" alt="文本 描述已自动生成"></p>
<p>连接WARP！</p>
<p><img src="/images/2023042200382134.png"></p>
<p>私有解析完成！</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>感谢Cloudflare为我们提供了这么好用的网络服务。小公司可以直接用Cloudflare Zero Trust 组建自己的内网了，然后用Firewall Policies进行适当的权限控制。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/05/01/zero-trust-private-dns/index/" data-id="clhp7rto100c4s2qrgntdhgy2" data-title="Cloudflare Zero Trust 添加私有解析DNS" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-cloudflare-access-gfwed-server/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/04/29/cloudflare-access-gfwed-server/index/" class="article-date">
  <time class="dt-published" datetime="2023-04-29T00:00:00.000Z" itemprop="datePublished">2023-04-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cloudflare/">cloudflare</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/04/29/cloudflare-access-gfwed-server/index/">使用Cloudflare Zero Trust连接被墙的服务器</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>我有些服务器被墙了，除了通过跳板机连接，还有什么好的办法吗？当然有了，使用Cloudflare Zero Trust即可。我们不仅可以使用ssh客户端，甚至还可以通过浏览器访问。除了SSH协议之外，RDP、SMB甚至任何奇奇怪怪的协议都可以。</p>
<h2 id="安装并连接cloudflared"><a href="#安装并连接cloudflared" class="headerlink" title="安装并连接cloudflared"></a>安装并连接cloudflared</h2><p>首先还是要想办法连接到被墙的机器，下载cloudflared</p>
<p><a target="_blank" rel="noopener" href="https://github.com/cloudflare/cloudflared/releases">https://github.com/cloudflare/cloudflared/releases</a></p>
<p>在网页上Access – Tunnels中创建一个 Tunnel，然后按照提示安装。</p>
<hr>
<h1 id="连接到服务器"><a href="#连接到服务器" class="headerlink" title="连接到服务器"></a>连接到服务器</h1><p>Cloudflare提供了三种通过tunnel连接到服务器的方式，第一种是通过客户端安装WARP，第二种是通过客户端安装<code>cloudflared</code>，第三种是直接通过浏览器访问。</p>
<h2 id="通过WARP连接服务器"><a href="#通过WARP连接服务器" class="headerlink" title="通过WARP连接服务器"></a>通过WARP连接服务器</h2><p>这种办法其实和<a target="_blank" rel="noopener" href="https://dmesg.app/cf-zero-trust.html">《使用Cloudflare Zero Trust创建大内网》</a>一样，区别只是创建大内网时，我们内网的设备写的是局域网IP，而这里则可能会写公网IP。但是本质上没有区别哒！</p>
<p>在网页上Tunnel中，配置<strong>Private Network</strong>，填入服务器的IP。如果类似GCP那种分配的内网IP，直接写内网IP对应的段也可以；否则直接写公网IP也可以。</p>
<p>老生常谈，创建Profile，表达式写比如说 <a href="mailto:ssh@dmesg.app">ssh@dmesg.app</a></p>
<p><img src="/images/2023042202404060.png" alt="图形用户界面 描述已自动生成"></p>
<p>Split Tunnel选择include，然后添加服务器的IP。</p>
<p><img src="/images/2023042202404112.png" alt="图形用户界面, 文本, 应用程序 描述已自动生成"></p>
<p>使用WARP连接，输入邮箱进行验证</p>
<p>WARP连接成功之后，就会发现能SSH啦，再也不怕GFW了</p>
<p><img src="/images/2023042202404290.png" alt="图形用户界面, 文本, 聊天或短信 描述已自动生成"></p>
<h2 id="通过cloudflared-access连接"><a href="#通过cloudflared-access连接" class="headerlink" title="通过cloudflared access连接"></a>通过cloudflared access连接</h2><p>在网页上，配置<strong>Public Hostname</strong>，下面Service Type选择SSH，URL写<code>127.0.0.1:22</code>，如果你想通过这个跳到其他服务器，那么就写<code>IP:22</code></p>
<p><img src="/images/2023042202404214.png" alt="图形用户界面, 文本, 应用程序 描述已自动生成"></p>
<p>客户端需要安装cloudflared，先登录 <code>cloudflared login</code></p>
<p>然后修改SSH配置文件 <code>~/.ssh/config</code></p>
<p>Host ssh.dmesg.app</p>
<h1 id="记得修改cloudflared路径"><a href="#记得修改cloudflared路径" class="headerlink" title="记得修改cloudflared路径"></a>记得修改cloudflared路径</h1><p>ProxyCommand &#x2F;opt&#x2F;homebrew&#x2F;bin&#x2F;cloudflared access ssh –hostname %h</p>
<p>然后再<code>ssh username@ssh.dmesg.app</code> 就可以啦</p>
<p>当然如果不想改config那么也可以</p>
<p>cloudflared access ssh –hostname ssh.dmesg.app –url 127.0.0.1:10022</p>
<p>然后另外一个窗口</p>
<p>ssh <a href="mailto:&#x72;&#x6f;&#111;&#116;&#x40;&#49;&#50;&#x37;&#46;&#x30;&#x2e;&#x30;&#x2e;&#49;">&#x72;&#x6f;&#111;&#116;&#x40;&#49;&#50;&#x37;&#46;&#x30;&#x2e;&#x30;&#x2e;&#49;</a> -p 10022</p>
<p>效果是一样的！</p>
<p>只要你的脑洞足够大，甚至可以通过<code>cloudflared access</code> 去连接任意TCP协议，甚至连UNIX套接字都可以哦</p>
<h2 id="使用浏览器连接"><a href="#使用浏览器连接" class="headerlink" title="使用浏览器连接"></a>使用浏览器连接</h2><p>同上，<strong>Public Hostname</strong>创建一个SSH服务，比如说域名叫 <code>browser.dmesg.app</code></p>
<p>然后 Application – Add Application – Self-hosted，application sub domain 同样写 <code>browser.dmesg.app</code></p>
<p>然后创建policies，和以前的方法一样，如果只是测试用甚至可以Everyone</p>
<p>下一步Additional Settings中，选择SSH</p>
<p><img src="/images/2023042202404319.png" alt="图形用户界面, 文本 描述已自动生成"></p>
<p><img src="/images/2023042202404461.png" alt="图形用户界面 低可信度描述已自动生成"></p>
<p>浏览器打开链接就可以了，注意这里的用户名是服务器的用户名，比如<code>root</code>，并不是进行邮箱验证的 <code>xxx@dmesg.app</code></p>
<p><img src="/images/2023042202404579.png" alt="图形用户界面, 文本, 应用程序, Teams 描述已自动生成"></p>
<p>下一步输入认证信息即可登录。根据服务器sshd配置不同，选择密码或者key登录即可。</p>
<p><img src="/images/2023042202404680.png" alt="文本 描述已自动生成"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/04/29/cloudflare-access-gfwed-server/index/" data-id="clhp7rtet000xs2qr2kqcfyc5" data-title="使用Cloudflare Zero Trust连接被墙的服务器" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-zero-trust-login-method/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/04/22/zero-trust-login-method/index/" class="article-date">
  <time class="dt-published" datetime="2023-04-22T00:00:00.000Z" itemprop="datePublished">2023-04-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cloudflare/">cloudflare</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/04/22/zero-trust-login-method/index/">Cloudflare Zero Trust App Launcher、Access Group及添加新的登录验证方式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="什么是App-Launcher"><a href="#什么是App-Launcher" class="headerlink" title="什么是App Launcher"></a>什么是App Launcher</h2><p>所谓App launcher，就是当用户登录之后，会显示一些应用，可以直接点击跳转过去。再也不用单独收藏每一个链接啦，只要收藏这个 App Launcher即可。长这样</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/04/2023042003361458.png"><img src="/images/2023042003361458.png"></a></p>
<h2 id="添加新登录验证方式"><a href="#添加新登录验证方式" class="headerlink" title="添加新登录验证方式"></a>添加新登录验证方式</h2><p>通常来讲，我们是通过邮件的方式来进行验证的。非常简单，但是有时邮件可能会发送失败，比如说被Gmail拦截。那么有没有办法添加新的验证方式呢？答案当然是有的啦。Cloudflare继承了非常多的登录方式，如下图所示，甚至有一个通用的SAML：</p>
<p><img src="/images/2023042003351149.png" alt="表格 描述已自动生成"></p>
<p>下面就以配置GitHub登录来说，Google等同理基本没太大差别。</p>
<h2 id="创建GitHub-App"><a href="#创建GitHub-App" class="headerlink" title="创建GitHub App"></a>创建GitHub App</h2><p>打开GitHub，进入Settings – Developer Settings – OAuth Apps，新建一个app</p>
<ul>
<li>Application name：随便写，自己记得就可以</li>
<li>Homepage URL： 你的team url，比如说 <a target="_blank" rel="noopener" href="https://bennythink.cloudflareaccess.com/">https://bennythink.cloudflareaccess.com/</a></li>
<li>Callback：同上，<a target="_blank" rel="noopener" href="https://bennythink.cloudflareaccess.com/cdn-cgi/access/callback">https://bennythink.cloudflareaccess.com/cdn-cgi/access/callback</a></li>
</ul>
<p>创建之后，复制 Client ID，然后点击Generate a new client secret 复制secret的值</p>
<h2 id="创建GitHub-Organization"><a href="#创建GitHub-Organization" class="headerlink" title="创建GitHub Organization"></a>创建GitHub Organization</h2><p>创建一个GitHub Organization，后续做验证的时候要用这个。</p>
<h2 id="配置Zero-Trust"><a href="#配置Zero-Trust" class="headerlink" title="配置Zero Trust"></a>配置Zero Trust</h2><p>回到Cloudflare Zero Trust，选择Settings – Authentication – Login Methods，右侧有一个Add new，然后选择GitHub</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/04/2023042003372621.png"><img src="/images/2023042003372621.png"></a></p>
<p>填入刚刚复制的ID和secret，点击保存</p>
<p> </p>
<p>下面会弹出一个小的框框</p>
<p><img src="/images/2023042003351386.png" alt="图形用户界面, 文本, 应用程序, 电子邮件 描述已自动生成"></p>
<p>点击finish setup或者复制链接到新窗口打开，在org中给我们新创建的org授权，点击Grant，然后authorize</p>
<p><img src="/images/2023042003351323.png" alt="图形用户界面, 文本, 应用程序 描述已自动生成"></p>
<p>此时回到Login Methods 就可以看到已经添加成功啦，点击 Test按钮可以看下Cloudflare从GitHub的API拿到的数据</p>
<p><img src="/images/2023042003351481.png" alt="背景图案 描述已自动生成"></p>
<h2 id="配置验证"><a href="#配置验证" class="headerlink" title="配置验证"></a>配置验证</h2><p>此时如果你打开 team url，比如 <a target="_blank" rel="noopener" href="https://bennythink.cloudflareaccess.com/">https://bennythink.cloudflareaccess.com/</a> 在Login就已经能看到GitHub了。</p>
<p><img src="/images/202304200335155.png" alt="图形用户界面, 应用程序 描述已自动生成"></p>
<p>当然这还没完，不能所有人都能通过GitHub OAuth进入App Launcher呀！因此我们还需要进一步配置</p>
<p>点开Zero Trust – Settings – App Launcher – Manage</p>
<p>首先确认一下Authentication页面已经选中了GitHub，默认应该是所有认证方式都可以，当然你也可以自定义</p>
<p><img src="/images/2023042003351550.png" alt="图形用户界面, 文本, 应用程序 描述已自动生成"></p>
<p>然后在Rules中，新建或者编辑已有规则，我们会发现有三种可以选择的模式： include、require和exclude</p>
<p><img src="/images/2023042003351695.png" alt="图形用户界面 描述已自动生成"></p>
<ul>
<li>include：类似逻辑OR操作符，用户只要满足条件之一就可以</li>
<li>require：类似逻辑AND操作符，用户要满足所有的条件</li>
<li>exclude：类似逻辑NOT，排除条件</li>
</ul>
<p>[v_error] 添加require规则的时候要注意，是要满足所有条件才可以授权。比如我的require规则添加了两条，分别是County&#x3D;China &amp; Country&#x3D;US，那么没人可以通过，因为IP只能在一个国家而不是两个国家。 [&#x2F;v_error]</p>
<p>这里我们的需求是，用户要么通过 dmesg.app 的邮箱验证，要么在新创建的那个Organization里，所以新添加一个include，Selector选择GitHub Organization，organization name写创建的name</p>
<p><img src="/images/2023042003351779.png" alt="图形用户界面, 文本, 应用程序 描述已自动生成"></p>
<p>如果我们的需求是，用户在org里，并且邮箱为 <a href="mailto:xxx@xxx.com">xxx@xxx.com</a>，那么就要一个include 邮箱规则，一个require GitHub organization规则。</p>
<p>返回 team url就可以登录了。</p>
<p>注意：配置 App Launcher的权限，并不等于拥有应用的权限，<strong>应用的权限是独立的</strong>。</p>
<p>举个例子，我之前创建的redis，只能邮箱进行验证，并且放到了launcher之中，那么在App Launcher这里我通过GitHub OAuth后，并看不到那个redis。想要看到对应的应用，那只能去编辑对应应用的规则。</p>
<h2 id="Access-Group"><a href="#Access-Group" class="headerlink" title="Access Group"></a>Access Group</h2><p>把一样的规则配置多次就显得很蠢，这个时候就要用Access Group。</p>
<p>Access – Access Group，设置名称和配置和前面一样</p>
<p><img src="/images/2023042003351846.png" alt="图形用户界面, 应用程序 描述已自动生成"></p>
<p>在其他地方，添加策略的时候选择这个Group就可以了。甚至在WARP的Device enrollment permissions中也可以这样搞！</p>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><p><a target="_blank" rel="noopener" href="https://developers.cloudflare.com/cloudflare-one/policies/access/">https://developers.cloudflare.com/cloudflare-one/policies/access/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/04/22/zero-trust-login-method/index/" data-id="clhp7rtnz00c2s2qrbtpb4apw" data-title="Cloudflare Zero Trust App Launcher、Access Group及添加新的登录验证方式" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/azure/">azure</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/china/">china</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/china/justsay/">justsay</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/cloudflare/">cloudflare</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/">it</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/it/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/">justsay</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/website/">website</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/program/">program</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/program/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/">security</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/security/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/share/">share</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/website/">website</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/website/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/what/">what</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/what/gfw/">gfw</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/09/28/worker-image-metadata/index/">使用 Cloudflare Worker获取图片元数据</a>
          </li>
        
          <li>
            <a href="/2024/09/27/workers-function/index/">将 Cloudflare Workers 迁移到 Azure Function</a>
          </li>
        
          <li>
            <a href="/2024/09/21/one-api-clickhouse/index/">one-api/new-api性能优化：使用 ClickHouse 作为日志系统</a>
          </li>
        
          <li>
            <a href="/2024/08/03/stripe-fraud/index/">Stripe 如何安全收款并避免盗刷与测卡</a>
          </li>
        
          <li>
            <a href="/2024/07/27/hide-in-cf/index/">隐藏于 Cloudflare 的全球网络之中</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Benny小土豆<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>